<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Using the `sparseR` package • sparseR</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Using the `sparseR` package">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">sparseR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.3.1.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item"><a class="nav-link" href="../articles/sparseR.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/petersonR/sparseR/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">



<script src="sparseR_files/kePrint-0.0.1/kePrint.js"></script><link href="sparseR_files/lightable-0.0.1/lightable.css" rel="stylesheet">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Using the `sparseR` package</h1>
                        <h4 data-toc-skip class="author">Ryan A.
Peterson</h4>
            
            <h4 data-toc-skip class="date">2024-07-18</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/petersonR/sparseR/blob/main/vignettes/sparseR.Rmd" class="external-link"><code>vignettes/sparseR.Rmd</code></a></small>
      <div class="d-none name"><code>sparseR.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>The <code>sparseR</code> package aids in the implementation of ranked
sparsity methods for model selection in the presence of interactions and
polynomials.</p>
<p>The following methods are supported, with help from
<code>ncvreg</code> on the backend:</p>
<ol style="list-style-type: decimal">
<li>The sparsity-ranked lasso (SRL)</li>
<li>Sparsity-ranked MCP/SCAD (SRM/SRS)</li>
<li>Sparsity-ranked elastic net (SREN)</li>
</ol>
<p>Additionally, <code>sparseR</code> makes it easy to preprocess data
and get it ready for looking at all candidate interactions of order
<code>k</code>, or all possible polynomials of order
<code>poly</code>.</p>
<p>This document goes through several use cases of the package on
different datasets.</p>
</div>
<div class="section level2">
<h2 id="use-case-iris-data">Use case: <code>iris</code> data<a class="anchor" aria-label="anchor" href="#use-case-iris-data"></a>
</h2>
<div class="section level3">
<h3 id="data-set-description">Data set description<a class="anchor" aria-label="anchor" href="#data-set-description"></a>
</h3>
<p>To illustrate in a simple case, consider Fisher’s Iris data set,
composed of 4 numeric variables and one categorical variable.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">iris</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">iris</span><span class="op">)</span></span>
<span><span class="co">##   Sepal.Length    Sepal.Width     Petal.Length    Petal.Width   </span></span>
<span><span class="co">##  Min.   :4.300   Min.   :2.000   Min.   :1.000   Min.   :0.100  </span></span>
<span><span class="co">##  1st Qu.:5.100   1st Qu.:2.800   1st Qu.:1.600   1st Qu.:0.300  </span></span>
<span><span class="co">##  Median :5.800   Median :3.000   Median :4.350   Median :1.300  </span></span>
<span><span class="co">##  Mean   :5.843   Mean   :3.057   Mean   :3.758   Mean   :1.199  </span></span>
<span><span class="co">##  3rd Qu.:6.400   3rd Qu.:3.300   3rd Qu.:5.100   3rd Qu.:1.800  </span></span>
<span><span class="co">##  Max.   :7.900   Max.   :4.400   Max.   :6.900   Max.   :2.500  </span></span>
<span><span class="co">##        Species  </span></span>
<span><span class="co">##  setosa    :50  </span></span>
<span><span class="co">##  versicolor:50  </span></span>
<span><span class="co">##  virginica :50  </span></span>
<span><span class="co">##                 </span></span>
<span><span class="co">##                 </span></span>
<span><span class="co">## </span></span></code></pre></div>
<p>If we are interested in predicting <code>Sepal.Width</code> based on
the other variables and their pairwise interactions, have a couple of
options. We can either use the built-in preprocessing for building the
model matrix and fitting the model, or we can manually build the model
matrix and pass it to the <code>sparseR</code> function.</p>
</div>
<div class="section level3">
<h3 id="using-formula-specification">Using formula specification<a class="anchor" aria-label="anchor" href="#using-formula-specification"></a>
</h3>
<p>Passing a <code>formula</code> to <code>sparseR</code> will tell the
function which main effects should be in the model. These are also the
main effects which will indicate which interactions/polynomials should
be investigated. Note that the formula will only accept main effect
terms, and will not allow specification of individual interaction
effects (or other functions of the main effects).</p>
<p>The sparsity-ranked lasso model for all-pairwise interactions can be
fit as follows (cross-validation is performed for <code>lambda</code>
via the <code>ncvreg</code> package, so it is important to set the seed
for reproducibililty).</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">srl</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sparseR.html">sparseR</a></span><span class="op">(</span><span class="va">Sepal.Width</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">iris</span>, k <span class="op">=</span> <span class="fl">1</span>, seed <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p>The print method will present useful results from these fits:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">srl</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Model summary @ min CV:</span></span>
<span><span class="co">## -----------------------------------------------------</span></span>
<span><span class="co">##   lasso-penalized linear regression with n=150, p=21</span></span>
<span><span class="co">##   (At lambda=0.0023):</span></span>
<span><span class="co">##     Nonzero coefficients: 7</span></span>
<span><span class="co">##     Cross-validation error (deviance): 0.07</span></span>
<span><span class="co">##     R-squared: 0.62</span></span>
<span><span class="co">##     Signal-to-noise ratio: 1.64</span></span>
<span><span class="co">##     Scale estimate (sigma): 0.267</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##   SR information:</span></span>
<span><span class="co">##              Vartype Total Selected Saturation Penalty</span></span>
<span><span class="co">##          Main effect     6        2      0.333    2.45</span></span>
<span><span class="co">##  Order 1 interaction    12        3      0.250    3.46</span></span>
<span><span class="co">##   Order 2 polynomial     3        2      0.667    3.00</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Model summary @ CV1se:</span></span>
<span><span class="co">## -----------------------------------------------------</span></span>
<span><span class="co">##   lasso-penalized linear regression with n=150, p=21</span></span>
<span><span class="co">##   (At lambda=0.0074):</span></span>
<span><span class="co">##     Nonzero coefficients: 6</span></span>
<span><span class="co">##     Cross-validation error (deviance): 0.08</span></span>
<span><span class="co">##     R-squared: 0.57</span></span>
<span><span class="co">##     Signal-to-noise ratio: 1.35</span></span>
<span><span class="co">##     Scale estimate (sigma): 0.284</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##   SR information:</span></span>
<span><span class="co">##              Vartype Total Selected Saturation Penalty</span></span>
<span><span class="co">##          Main effect     6        2      0.333    2.45</span></span>
<span><span class="co">##  Order 1 interaction    12        2      0.167    3.46</span></span>
<span><span class="co">##   Order 2 polynomial     3        2      0.667    3.00</span></span></code></pre></div>
<p>For more detailed model information, the <code>summary</code> method
for <code>sparseR</code> objects displays more information about the
fits (see <code><a href="https://rdrr.io/pkg/ncvreg/man/summary.ncvreg.html" class="external-link">?ncvreg::summary.ncvreg</a></code> for more
information).</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># At the lambda which minimizes CVE</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">srl</span>, at <span class="op">=</span> <span class="st">"cvmin"</span><span class="op">)</span></span>
<span><span class="co">## lasso-penalized linear regression with n=150, p=21</span></span>
<span><span class="co">## At lambda=0.0023:</span></span>
<span><span class="co">## -------------------------------------------------</span></span>
<span><span class="co">##   Nonzero coefficients         :   7</span></span>
<span><span class="co">##   Expected nonzero coefficients:   2.00</span></span>
<span><span class="co">##   Average mfdr (7 features)    :   0.286</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##                                 Estimate       z       mfdr Selected</span></span>
<span><span class="co">## Species_setosa                  1.106390 25.6231    &lt; 1e-04        *</span></span>
<span><span class="co">## Sepal.Length:Species_setosa     0.376189 10.1686    &lt; 1e-04        *</span></span>
<span><span class="co">## Sepal.Length_poly_1             0.167953  8.4066    &lt; 1e-04        *</span></span>
<span><span class="co">## Petal.Width_poly_2              0.135230  5.6513    &lt; 1e-04        *</span></span>
<span><span class="co">## Petal.Width:Species_versicolor  0.467836  4.1960 0.00063055        *</span></span>
<span><span class="co">## Sepal.Length:Petal.Length      -0.006347 -0.6651 1.00000000        *</span></span>
<span><span class="co">## Sepal.Length_poly_2            -0.011020 -0.9665 1.00000000        *</span></span>
<span></span>
<span><span class="co"># At the lambda which is within 1 SE of the minimum CVE</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">srl</span>, at <span class="op">=</span> <span class="st">"cv1se"</span><span class="op">)</span></span>
<span><span class="co">## lasso-penalized linear regression with n=150, p=21</span></span>
<span><span class="co">## At lambda=0.0074:</span></span>
<span><span class="co">## -------------------------------------------------</span></span>
<span><span class="co">##   Nonzero coefficients         :   6</span></span>
<span><span class="co">##   Expected nonzero coefficients:   1.10</span></span>
<span><span class="co">##   Average mfdr (6 features)    :   0.183</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##                                Estimate      z       mfdr Selected</span></span>
<span><span class="co">## Species_setosa                  0.80638 18.013    &lt; 1e-04        *</span></span>
<span><span class="co">## Sepal.Length_poly_1             0.19734  9.713    &lt; 1e-04        *</span></span>
<span><span class="co">## Petal.Width_poly_2              0.09871  4.614 0.00024977        *</span></span>
<span><span class="co">## Petal.Width:Species_versicolor  0.27739  3.259 0.04655092        *</span></span>
<span><span class="co">## Sepal.Length_poly_2            -0.03363 -2.804 0.21141507        *</span></span>
<span><span class="co">## Sepal.Length:Species_setosa     0.04275  2.190 0.84164385        *</span></span></code></pre></div>
<p>Finally, plots of either the cross-validation error across
<code>lambda</code> values or the coefficient paths can be produced
fairly easily:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">srl</span>, plot_type <span class="op">=</span> <span class="st">"cv"</span><span class="op">)</span></span></code></pre></div>
<p><img src="sparseR_files/figure-html/unnamed-chunk-5-1.png" width="672"></p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">srl</span>, plot_type <span class="op">=</span> <span class="st">"path"</span><span class="op">)</span></span></code></pre></div>
<p><img src="sparseR_files/figure-html/unnamed-chunk-6-1.png" width="672"></p>
<p>Importantly, since <code>sparseR</code> with a formula centers and
scales the covariates prior to forming interactions, the coefficients
should be interpreted this way (a 1-unit change in the covariate
corresponds to a 1 SD change in the unit of the main effect, and
parameters involving interactions must be interpreted at the mean value
of involved covariates).</p>
</div>
<div class="section level3">
<h3 id="using-model-matrix-specification">Using model matrix specification<a class="anchor" aria-label="anchor" href="#using-model-matrix-specification"></a>
</h3>
<p>Since the <code>sparseR</code> preprocessing has limits to its
customizability, and often it will be of interest to create interactions
that are centered at prespecified values (as opposed to their mean), it
is also possible to feed in a matrix to <code>sparseR</code> that has
already been preprocessed. The function also allows users to circumvent
the recipes functionality and supply their own model matrix, composed of
interactions and/or polynomials. This may be useful in cases where users
wish to:</p>
<ul>
<li>specify their own missing data imputation methods,</li>
<li>specify the intercept differently than a grand mean (avoid centering
variables prior to making certain interactions of interest)</li>
<li>scale variables differently</li>
</ul>
<p>The key arguments for this purpose are to set
<code>pre_process</code> to <code>FALSE</code>, and supply
<code>model_matrix</code> and the outcome <code>y</code>. Users may also
want to specify how the model matrix is specified in terms of polynomial
order (the package requires a prefix, such as “poly_1”, or “poly_2” to
denote polynomial terms of orders 1 and 2 respectively) and interaction
seperator (by default, this is “\\:”, which is the default for
<code>model.matrix</code>).</p>
<p>The code below creates a model matrix will all pairwise interactions,
however as opposed to the formula, the numeric variables are not
centered prior to forming the interactions, and the factor variable of
species will be given a reference category (as opposed to a cell-means
specification). Therefore, this method will lead to different
results.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">X</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/model.matrix.html" class="external-link">model.matrix</a></span><span class="op">(</span><span class="va">Sepal.Width</span> <span class="op">~</span> <span class="va">.</span><span class="op">*</span><span class="va">.</span>, data <span class="op">=</span> <span class="va">iris</span><span class="op">)</span><span class="op">[</span>,<span class="op">-</span><span class="fl">1</span><span class="op">]</span></span></code></pre></div>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">srl2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sparseR.html">sparseR</a></span><span class="op">(</span>pre_process <span class="op">=</span> <span class="cn">FALSE</span>, model_matrix <span class="op">=</span> <span class="va">X</span>, y <span class="op">=</span> <span class="va">iris</span><span class="op">$</span><span class="va">Sepal.Width</span><span class="op">)</span></span>
<span><span class="co">## Warning in ncvreg(X = X, y = y, ...): Maximum number of iterations reached</span></span></code></pre></div>
<p>Since we have a warning about iterations, note that we can pass
through arguments to <code>ncvreg</code> and fix this issue:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">srl2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sparseR.html">sparseR</a></span><span class="op">(</span>pre_process <span class="op">=</span> <span class="cn">FALSE</span>, model_matrix <span class="op">=</span> <span class="va">X</span>, y <span class="op">=</span> <span class="va">iris</span><span class="op">$</span><span class="va">Sepal.Width</span>, max.iter <span class="op">=</span> <span class="fl">1e6</span><span class="op">)</span></span></code></pre></div>
<p>And we can use the same S3 methods to get more information about the
SRL model:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">srl2</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Model summary @ min CV:</span></span>
<span><span class="co">## -----------------------------------------------------</span></span>
<span><span class="co">##   lasso-penalized linear regression with n=150, p=14</span></span>
<span><span class="co">##   (At lambda=0.0005):</span></span>
<span><span class="co">##     Nonzero coefficients: 8</span></span>
<span><span class="co">##     Cross-validation error (deviance): 0.07</span></span>
<span><span class="co">##     R-squared: 0.64</span></span>
<span><span class="co">##     Signal-to-noise ratio: 1.77</span></span>
<span><span class="co">##     Scale estimate (sigma): 0.261</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##   SR information:</span></span>
<span><span class="co">##              Vartype Total Selected Saturation Penalty</span></span>
<span><span class="co">##          Main effect     5        3      0.600    2.24</span></span>
<span><span class="co">##  Order 1 interaction     9        5      0.556    3.00</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Model summary @ CV1se:</span></span>
<span><span class="co">## -----------------------------------------------------</span></span>
<span><span class="co">##   lasso-penalized linear regression with n=150, p=14</span></span>
<span><span class="co">##   (At lambda=0.0021):</span></span>
<span><span class="co">##     Nonzero coefficients: 5</span></span>
<span><span class="co">##     Cross-validation error (deviance): 0.08</span></span>
<span><span class="co">##     R-squared: 0.59</span></span>
<span><span class="co">##     Signal-to-noise ratio: 1.46</span></span>
<span><span class="co">##     Scale estimate (sigma): 0.277</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##   SR information:</span></span>
<span><span class="co">##              Vartype Total Selected Saturation Penalty</span></span>
<span><span class="co">##          Main effect     5        4      0.800    2.24</span></span>
<span><span class="co">##  Order 1 interaction     9        1      0.111    3.00</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">srl2</span>, at <span class="op">=</span> <span class="st">"cv1se"</span><span class="op">)</span></span>
<span><span class="co">## lasso-penalized linear regression with n=150, p=14</span></span>
<span><span class="co">## At lambda=0.0021:</span></span>
<span><span class="co">## -------------------------------------------------</span></span>
<span><span class="co">##   Nonzero coefficients         :   5</span></span>
<span><span class="co">##   Expected nonzero coefficients:   0.00</span></span>
<span><span class="co">##   Average mfdr (5 features)    :   0.000</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##                           Estimate      z    mfdr Selected</span></span>
<span><span class="co">## Speciesvirginica           -1.1502 -25.15 &lt; 1e-04        *</span></span>
<span><span class="co">## Speciesversicolor          -1.0558 -23.10 &lt; 1e-04        *</span></span>
<span><span class="co">## Sepal.Length                0.4243  16.32 &lt; 1e-04        *</span></span>
<span><span class="co">## Petal.Width                 0.3390  12.06 &lt; 1e-04        *</span></span>
<span><span class="co">## Sepal.Length:Petal.Length  -0.0189 -11.68 &lt; 1e-04        *</span></span></code></pre></div>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">srl2</span><span class="op">)</span></span></code></pre></div>
<p><img src="sparseR_files/figure-html/unnamed-chunk-12-1.png" width="672"></p>
<p>Since we did not center/scale any of the variables prior to this
fitting procedure, the interpretation of these coefficients should be on
the original scale of the predictors, and the origin for the terms
involved in interactions is 0, not at the mean of their constituent
covariates.</p>
<p>Note also that there are fewer total covariates listed. This is
because <code>model.matrix</code> uses reference cell dummy variables by
default. Another way to do this without the reference category
specification would be to pass pre-process options to
<code>sparseR</code>, or to manually use <code>sparseR_prep</code> to
create the model matrix.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span> </span>
<span><span class="va">srl3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sparseR.html">sparseR</a></span><span class="op">(</span><span class="va">Sepal.Width</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">iris</span>, k <span class="op">=</span> <span class="fl">1</span>, </span>
<span>                pre_proc_opts <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"none"</span><span class="op">)</span>, max.iter <span class="op">=</span> <span class="fl">1e6</span><span class="op">)</span></span>
<span><span class="va">srl3</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Model summary @ min CV:</span></span>
<span><span class="co">## -----------------------------------------------------</span></span>
<span><span class="co">##   lasso-penalized linear regression with n=150, p=21</span></span>
<span><span class="co">##   (At lambda=0.0006):</span></span>
<span><span class="co">##     Nonzero coefficients: 6</span></span>
<span><span class="co">##     Cross-validation error (deviance): 0.07</span></span>
<span><span class="co">##     R-squared: 0.64</span></span>
<span><span class="co">##     Signal-to-noise ratio: 1.80</span></span>
<span><span class="co">##     Scale estimate (sigma): 0.259</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##   SR information:</span></span>
<span><span class="co">##              Vartype Total Selected Saturation Penalty</span></span>
<span><span class="co">##          Main effect     6        2      0.333    2.45</span></span>
<span><span class="co">##  Order 1 interaction    12        4      0.333    3.46</span></span>
<span><span class="co">##   Order 2 polynomial     3        0      0.000    3.00</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Model summary @ CV1se:</span></span>
<span><span class="co">## -----------------------------------------------------</span></span>
<span><span class="co">##   lasso-penalized linear regression with n=150, p=21</span></span>
<span><span class="co">##   (At lambda=0.0041):</span></span>
<span><span class="co">##     Nonzero coefficients: 5</span></span>
<span><span class="co">##     Cross-validation error (deviance): 0.08</span></span>
<span><span class="co">##     R-squared: 0.59</span></span>
<span><span class="co">##     Signal-to-noise ratio: 1.47</span></span>
<span><span class="co">##     Scale estimate (sigma): 0.277</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##   SR information:</span></span>
<span><span class="co">##              Vartype Total Selected Saturation Penalty</span></span>
<span><span class="co">##          Main effect     6        2      0.333    2.45</span></span>
<span><span class="co">##  Order 1 interaction    12        2      0.167    3.46</span></span>
<span><span class="co">##   Order 2 polynomial     3        1      0.333    3.00</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">srl3</span>, at <span class="op">=</span> <span class="st">"cv1se"</span><span class="op">)</span></span>
<span><span class="co">## lasso-penalized linear regression with n=150, p=21</span></span>
<span><span class="co">## At lambda=0.0041:</span></span>
<span><span class="co">## -------------------------------------------------</span></span>
<span><span class="co">##   Nonzero coefficients         :   5</span></span>
<span><span class="co">##   Expected nonzero coefficients:   1.32</span></span>
<span><span class="co">##   Average mfdr (5 features)    :   0.264</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##                             Estimate      z    mfdr Selected</span></span>
<span><span class="co">## Sepal.Length:Species_setosa  0.18862 21.079 &lt; 1e-04        *</span></span>
<span><span class="co">## Sepal.Length_poly_1          0.23292  9.248 &lt; 1e-04        *</span></span>
<span><span class="co">## Petal.Width_poly_2           0.06659  6.116 &lt; 1e-04        *</span></span>
<span><span class="co">## Species_virginica           -0.08945 -2.387 0.32168        *</span></span>
<span><span class="co">## Petal.Width:Species_setosa   0.14950  1.542 1.00000        *</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="centering-to-different-values">Centering to different values<a class="anchor" aria-label="anchor" href="#centering-to-different-values"></a>
</h3>
<p>In many cases with interactions, it makes sense to center variables
to certain values (or rather, it does <strong>not</strong> make sense to
center variables to their mean or to zero). Therefore we built some
flexibility into <code>sparseR</code> and <code>sparseR_prep</code> in
order to allow users to change these as the context dictates.</p>
<p>Each covariate’s centering location (in this case their minima) can
be passed into <code>sparseR_prep</code> as follows:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cc</span> <span class="op">&lt;-</span> <span class="va">iris</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu">select</span><span class="op">(</span><span class="va">Sepal.Length</span>, <span class="va">Petal.Length</span>, <span class="va">Petal.Width</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="fl">2</span>, <span class="va">min</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sparseR_prep.html">sparseR_prep</a></span><span class="op">(</span><span class="va">Sepal.Width</span> <span class="op">~</span> <span class="va">.</span>, <span class="va">iris</span>, k <span class="op">=</span> <span class="fl">0</span>, extra_opts <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>centers <span class="op">=</span> <span class="va">cc</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">(</span><span class="va">c2min</span> <span class="op">&lt;-</span> <span class="fu">bake</span><span class="op">(</span><span class="va">p1</span>, <span class="va">iris</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">## <span style="color: #949494;"># A tibble: 150 × 6</span></span></span>
<span><span class="co">##    Sepal.Length Petal.Length Petal.Width Species_setosa Species_versicolor</span></span>
<span><span class="co">##           <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span>        0.966        0.227       0.131              1                  0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span>        0.725        0.227       0.131              1                  0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span>        0.483        0.170       0.131              1                  0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span>        0.362        0.283       0.131              1                  0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span>        0.845        0.227       0.131              1                  0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span>        1.33         0.397       0.394              1                  0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span>        0.362        0.227       0.262              1                  0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span>        0.845        0.283       0.131              1                  0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span>        0.121        0.227       0.131              1                  0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span>        0.725        0.283       0                  1                  0</span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 140 more rows</span></span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 1 more variable: Species_virginica &lt;dbl&gt;</span></span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">c2min</span><span class="op">)</span></span>
<span><span class="co">##   Sepal.Length     Petal.Length     Petal.Width     Species_setosa  </span></span>
<span><span class="co">##  Min.   :0.0000   Min.   :0.0000   Min.   :0.0000   Min.   :0.0000  </span></span>
<span><span class="co">##  1st Qu.:0.9661   1st Qu.:0.3399   1st Qu.:0.2624   1st Qu.:0.0000  </span></span>
<span><span class="co">##  Median :1.8115   Median :1.8977   Median :1.5743   Median :0.0000  </span></span>
<span><span class="co">##  Mean   :1.8638   Mean   :1.5623   Mean   :1.4422   Mean   :0.3333  </span></span>
<span><span class="co">##  3rd Qu.:2.5360   3rd Qu.:2.3226   3rd Qu.:2.2303   3rd Qu.:1.0000  </span></span>
<span><span class="co">##  Max.   :4.3475   Max.   :3.3422   Max.   :3.1486   Max.   :1.0000  </span></span>
<span><span class="co">##  Species_versicolor Species_virginica</span></span>
<span><span class="co">##  Min.   :0.0000     Min.   :0.0000   </span></span>
<span><span class="co">##  1st Qu.:0.0000     1st Qu.:0.0000   </span></span>
<span><span class="co">##  Median :0.0000     Median :0.0000   </span></span>
<span><span class="co">##  Mean   :0.3333     Mean   :0.3333   </span></span>
<span><span class="co">##  3rd Qu.:1.0000     3rd Qu.:1.0000   </span></span>
<span><span class="co">##  Max.   :1.0000     Max.   :1.0000</span></span></code></pre></div>
<p>Or directly into <code>sparseR</code>:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">srl_centered2min</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sparseR.html">sparseR</a></span><span class="op">(</span><span class="va">Sepal.Width</span> <span class="op">~</span> <span class="va">.</span>, <span class="va">iris</span>, extra_opts <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>centers <span class="op">=</span> <span class="va">cc</span><span class="op">)</span>, seed <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p>Or, a function can be passed to evaluate the location for each
covariate:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sparseR_prep.html">sparseR_prep</a></span><span class="op">(</span><span class="va">Sepal.Width</span> <span class="op">~</span> <span class="va">.</span>, <span class="va">iris</span>, k <span class="op">=</span> <span class="fl">0</span>, extra_opts <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>center_fn <span class="op">=</span> <span class="va">min</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">(</span><span class="va">c2min2</span> <span class="op">&lt;-</span> <span class="fu">bake</span><span class="op">(</span><span class="va">p2</span>, <span class="va">iris</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">## <span style="color: #949494;"># A tibble: 150 × 6</span></span></span>
<span><span class="co">##    Sepal.Length Petal.Length Petal.Width Species_setosa Species_versicolor</span></span>
<span><span class="co">##           <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span>        0.966        0.227       0.131              1                  0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span>        0.725        0.227       0.131              1                  0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span>        0.483        0.170       0.131              1                  0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span>        0.362        0.283       0.131              1                  0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span>        0.845        0.227       0.131              1                  0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span>        1.33         0.397       0.394              1                  0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span>        0.362        0.227       0.262              1                  0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span>        0.845        0.283       0.131              1                  0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span>        0.121        0.227       0.131              1                  0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span>        0.725        0.283       0                  1                  0</span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 140 more rows</span></span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 1 more variable: Species_virginica &lt;dbl&gt;</span></span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/identical.html" class="external-link">identical</a></span><span class="op">(</span><span class="va">c2min2</span>, <span class="va">c2min</span><span class="op">)</span></span>
<span><span class="co">## [1] TRUE</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="plotting-the-model">Plotting the model<a class="anchor" aria-label="anchor" href="#plotting-the-model"></a>
</h3>
<p>Interactions are notoriously difficult to understand and to
communicate, and visualizations can often be helpful. The
<code>sparseR</code> package has some limited functionality for plotting
the results from these fits, using the <code>visreg</code> package as a
rough guide.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/effect_plot.html">effect_plot</a></span><span class="op">(</span><span class="va">srl</span>, <span class="st">"Petal.Width"</span>, by <span class="op">=</span> <span class="st">"Species"</span><span class="op">)</span></span></code></pre></div>
<p><img src="sparseR_files/figure-html/unnamed-chunk-17-1.png" width="672"></p>
<p>Notice how this changes if the covariates are centered to their
minima instead:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/effect_plot.html">effect_plot</a></span><span class="op">(</span><span class="va">srl_centered2min</span>, <span class="st">"Petal.Width"</span>, by <span class="op">=</span> <span class="st">"Species"</span><span class="op">)</span></span></code></pre></div>
<p><img src="sparseR_files/figure-html/unnamed-chunk-18-1.png" width="672"></p>
<p>It’s clear that the model itself can change quite a bit depending on
the center location utilized prior to building the interactions.
Unfortunately, optimizing the center location for each covariate is a
difficult, p-dimensional problem (set in the context of another
difficult optimization problem of regularized regression with multiple
tuning parameters).</p>
<p>The <code>sparseR</code> package will allow users to compare certain
choices in terms of their cross-validated error, which is a decent
starting point. The plot below shows how the “centered to zero” model
has <em>slightly</em> lower cross-validated error than the best
mean-centered model and the best minimum-centered model.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">srl3</span>, plot_type <span class="op">=</span> <span class="st">"cv"</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">.2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>h <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">srl3</span><span class="op">$</span><span class="va">fit</span><span class="op">$</span><span class="va">cve</span><span class="op">)</span>, col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">srl_centered2min</span>, plot_type <span class="op">=</span> <span class="st">"cv"</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">.2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>h <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">srl3</span><span class="op">$</span><span class="va">fit</span><span class="op">$</span><span class="va">cve</span><span class="op">)</span>, col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">srl</span>, plot_type <span class="op">=</span> <span class="st">"cv"</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">.2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>h <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">srl3</span><span class="op">$</span><span class="va">fit</span><span class="op">$</span><span class="va">cve</span><span class="op">)</span>, col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/effect_plot.html">effect_plot</a></span><span class="op">(</span><span class="va">srl3</span>, <span class="st">"Petal.Width"</span>, by <span class="op">=</span> <span class="st">"Species"</span>, </span>
<span>            plot.args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.5</span>, <span class="fl">4.8</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/effect_plot.html">effect_plot</a></span><span class="op">(</span><span class="va">srl_centered2min</span>, <span class="st">"Petal.Width"</span>, by <span class="op">=</span> <span class="st">"Species"</span>, </span>
<span>            plot.args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.5</span>, <span class="fl">4.8</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/effect_plot.html">effect_plot</a></span><span class="op">(</span><span class="va">srl</span>, <span class="st">"Petal.Width"</span>, by <span class="op">=</span> <span class="st">"Species"</span>, </span>
<span>            plot.args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.5</span>, <span class="fl">4.8</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="sparseR_files/figure-html/unnamed-chunk-20-1.png" width="100%"></p>
<p>Though these models look substantially different, it’s worth noting
that the predictions obtained from the three models are very close to
one another (since the models look similar in the neighborhood of
existing data):</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">srl3</span>, at <span class="op">=</span> <span class="st">"cvmin"</span><span class="op">)</span></span>
<span><span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">srl_centered2min</span>, at <span class="op">=</span> <span class="st">"cvmin"</span><span class="op">)</span></span>
<span><span class="va">p3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">srl</span>, at <span class="op">=</span> <span class="st">"cvmin"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">p1</span>, <span class="va">p2</span> ,<span class="va">p3</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">##           p1        p2        p3</span></span>
<span><span class="co">## p1 1.0000000 0.9903513 0.9873102</span></span>
<span><span class="co">## p2 0.9903513 1.0000000 0.9898124</span></span>
<span><span class="co">## p3 0.9873102 0.9898124 1.0000000</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/pairs.html" class="external-link">pairs</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">p1</span>, <span class="va">p2</span> ,<span class="va">p3</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="sparseR_files/figure-html/unnamed-chunk-21-1.png" width="672"></p>
<p>At the CV1se lambda value, there is slightly less agreement in these
predictions:</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># At CV1se</span></span>
<span><span class="va">p4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">srl3</span>, at <span class="op">=</span> <span class="st">"cv1se"</span><span class="op">)</span></span>
<span><span class="va">p5</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">srl_centered2min</span>, at <span class="op">=</span> <span class="st">"cv1se"</span><span class="op">)</span></span>
<span><span class="va">p6</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">srl</span>, at <span class="op">=</span> <span class="st">"cv1se"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">p1</span>, <span class="va">p2</span> ,<span class="va">p3</span>, <span class="va">p4</span>,<span class="va">p5</span>,<span class="va">p6</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">##           p1        p2        p3        p4        p5        p6</span></span>
<span><span class="co">## p1 1.0000000 0.9903513 0.9873102 0.9781221 0.9586728 0.9752579</span></span>
<span><span class="co">## p2 0.9903513 1.0000000 0.9898124 0.9714612 0.9784280 0.9627639</span></span>
<span><span class="co">## p3 0.9873102 0.9898124 1.0000000 0.9706405 0.9671849 0.9821402</span></span>
<span><span class="co">## p4 0.9781221 0.9714612 0.9706405 1.0000000 0.9709760 0.9845977</span></span>
<span><span class="co">## p5 0.9586728 0.9784280 0.9671849 0.9709760 1.0000000 0.9504649</span></span>
<span><span class="co">## p6 0.9752579 0.9627639 0.9821402 0.9845977 0.9504649 1.0000000</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/pairs.html" class="external-link">pairs</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">p1</span>, <span class="va">p2</span> ,<span class="va">p3</span>, <span class="va">p4</span>,<span class="va">p5</span>,<span class="va">p6</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="sparseR_files/figure-html/unnamed-chunk-22-1.png" width="672"></p>
<p><img src="sparseR_files/figure-html/unnamed-chunk-23-1.png" width="672"></p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/effect_plot.html">effect_plot</a></span><span class="op">(</span><span class="va">srl3</span>, <span class="st">"Petal.Width"</span>, by <span class="op">=</span> <span class="st">"Species"</span>, at <span class="op">=</span> <span class="st">"cv1se"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/effect_plot.html">effect_plot</a></span><span class="op">(</span><span class="va">srl_centered2min</span>, <span class="st">"Petal.Width"</span>, by <span class="op">=</span> <span class="st">"Species"</span>, at <span class="op">=</span> <span class="st">"cv1se"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/effect_plot.html">effect_plot</a></span><span class="op">(</span><span class="va">srl</span>, <span class="st">"Petal.Width"</span>, by <span class="op">=</span> <span class="st">"Species"</span>, at <span class="op">=</span> <span class="st">"cv1se"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="using-stepwise-rbic">Using stepwise RBIC<a class="anchor" aria-label="anchor" href="#using-stepwise-rbic"></a>
</h3>
<p>RBIC, or <em>Ranked-sparsity Bayesian Information Criterion</em>, is
a ranked sparsity model selection criterion that will correctly penalize
interactions (higher than main effects). The benefit of using a stepwise
approach informed by RBIC is that there is no shrinkage, and it thus
doesn’t matter whether or not (or where) the covariates are centered
(usually). The exceptions here occur when the stepwise process is not
sequential/hierarchical (i.e. main effects first, then interactions of
the “active” main effects, etc.).</p>
<p>Inference on the parameters is still i) difficult because one must
account for post-selection inference, and ii) affected by where and
whether the covariates are centered. However, the lines themselves will
not be affected by centering status.</p>
<p>We can see this in the examples below:</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Centered model</span></span>
<span><span class="op">(</span><span class="va">rbic1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sparseRBIC_step.html">sparseRBIC_step</a></span><span class="op">(</span><span class="va">Sepal.Width</span> <span class="op">~</span> <span class="va">.</span>, <span class="va">iris</span>, pre_proc_opts <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"center"</span>, <span class="st">"scale"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">## Note: sparseRBIC_step is currently experimental and may not behave as expected.</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Call:  glm(formula = y ~ Species_setosa + Sepal.Length + Petal.Width + </span></span>
<span><span class="co">##     Species_versicolor + Petal.Length + `Sepal.Length:Species_setosa`, </span></span>
<span><span class="co">##     family = family, data = X)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Coefficients:</span></span>
<span><span class="co">##                   (Intercept)                 Species_setosa  </span></span>
<span><span class="co">##                       2.40062                        2.14130  </span></span>
<span><span class="co">##                  Sepal.Length                    Petal.Width  </span></span>
<span><span class="co">##                       0.16506                        0.44726  </span></span>
<span><span class="co">##            Species_versicolor                   Petal.Length  </span></span>
<span><span class="co">##                       0.29340                       -0.05916  </span></span>
<span><span class="co">## `Sepal.Length:Species_setosa`  </span></span>
<span><span class="co">##                       0.45943  </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Degrees of Freedom: 149 Total (i.e. Null);  143 Residual</span></span>
<span><span class="co">## Null Deviance:       28.31 </span></span>
<span><span class="co">## Residual Deviance: 8.999     AIC: 19.65</span></span>
<span></span>
<span><span class="co"># Non-centered model</span></span>
<span><span class="op">(</span><span class="va">rbic2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sparseRBIC_step.html">sparseRBIC_step</a></span><span class="op">(</span><span class="va">Sepal.Width</span> <span class="op">~</span> <span class="va">.</span>, <span class="va">iris</span>, pre_proc_opts <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"scale"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">## Note: sparseRBIC_step is currently experimental and may not behave as expected.</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Call:  glm(formula = y ~ Species_setosa + Sepal.Length + Petal.Width + </span></span>
<span><span class="co">##     Species_versicolor + Petal.Length + `Sepal.Length:Species_setosa`, </span></span>
<span><span class="co">##     family = family, data = X)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Coefficients:</span></span>
<span><span class="co">##                   (Intercept)                 Species_setosa  </span></span>
<span><span class="co">##                       0.65809                       -1.10073  </span></span>
<span><span class="co">##                  Sepal.Length                    Petal.Width  </span></span>
<span><span class="co">##                       0.16506                        0.44726  </span></span>
<span><span class="co">##            Species_versicolor                   Petal.Length  </span></span>
<span><span class="co">##                       0.29340                       -0.05916  </span></span>
<span><span class="co">## `Sepal.Length:Species_setosa`  </span></span>
<span><span class="co">##                       0.45943  </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Degrees of Freedom: 149 Total (i.e. Null);  143 Residual</span></span>
<span><span class="co">## Null Deviance:       28.31 </span></span>
<span><span class="co">## Residual Deviance: 8.999     AIC: 19.65</span></span></code></pre></div>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/effect_plot.html">effect_plot</a></span><span class="op">(</span><span class="va">rbic1</span>, <span class="st">"Petal.Width"</span>, by <span class="op">=</span> <span class="st">"Species"</span>, plot.args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.5</span>, <span class="fl">5</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/effect_plot.html">effect_plot</a></span><span class="op">(</span><span class="va">rbic2</span>, <span class="st">"Petal.Width"</span>, by <span class="op">=</span> <span class="st">"Species"</span>, plot.args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.5</span>, <span class="fl">5</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/effect_plot.html">effect_plot</a></span><span class="op">(</span><span class="va">rbic1</span>, <span class="st">"Sepal.Length"</span>, by <span class="op">=</span> <span class="st">"Species"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/effect_plot.html">effect_plot</a></span><span class="op">(</span><span class="va">rbic2</span>, <span class="st">"Sepal.Length"</span>, by <span class="op">=</span> <span class="st">"Species"</span><span class="op">)</span></span></code></pre></div>
<p><img src="sparseR_files/figure-html/unnamed-chunk-27-1.png" width="576"></p>
<p>Again similar S3 methods are available (note how inference does
change for certain parameters based on the centering status). A message
is produced because these p-values do not account for post-selection
inference.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">rbic1</span><span class="op">)</span></span>
<span><span class="co">## P-values have **not** been corrected for multiple comparisons</span></span>
<span><span class="co">## Consider sparseRBIC_sampsplit() or sparseRBIC_bootstrap()</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Call:</span></span>
<span><span class="co">## glm(formula = y ~ Species_setosa + Sepal.Length + Petal.Width + </span></span>
<span><span class="co">##     Species_versicolor + Petal.Length + `Sepal.Length:Species_setosa`, </span></span>
<span><span class="co">##     family = family, data = X)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Coefficients:</span></span>
<span><span class="co">##                               Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">## (Intercept)                    2.40062    0.12025  19.964  &lt; 2e-16 ***</span></span>
<span><span class="co">## Species_setosa                 2.14130    0.30584   7.001 9.10e-11 ***</span></span>
<span><span class="co">## Sepal.Length                   0.16506    0.06017   2.743  0.00687 ** </span></span>
<span><span class="co">## Petal.Width                    0.44726    0.08833   5.064 1.25e-06 ***</span></span>
<span><span class="co">## Species_versicolor             0.29340    0.09839   2.982  0.00337 ** </span></span>
<span><span class="co">## Petal.Length                  -0.05916    0.15021  -0.394  0.69428    </span></span>
<span><span class="co">## `Sepal.Length:Species_setosa`  0.45943    0.09997   4.596 9.40e-06 ***</span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## (Dispersion parameter for gaussian family taken to be 0.06292687)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##     Null deviance: 28.3069  on 149  degrees of freedom</span></span>
<span><span class="co">## Residual deviance:  8.9985  on 143  degrees of freedom</span></span>
<span><span class="co">## AIC: 19.646</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Number of Fisher Scoring iterations: 2</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">rbic2</span><span class="op">)</span></span>
<span><span class="co">## P-values have **not** been corrected for multiple comparisons</span></span>
<span><span class="co">## Consider sparseRBIC_sampsplit() or sparseRBIC_bootstrap()</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Call:</span></span>
<span><span class="co">## glm(formula = y ~ Species_setosa + Sepal.Length + Petal.Width + </span></span>
<span><span class="co">##     Species_versicolor + Petal.Length + `Sepal.Length:Species_setosa`, </span></span>
<span><span class="co">##     family = family, data = X)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Coefficients:</span></span>
<span><span class="co">##                               Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">## (Intercept)                    0.65809    0.31114   2.115  0.03616 *  </span></span>
<span><span class="co">## Species_setosa                -1.10073    0.60258  -1.827  0.06983 .  </span></span>
<span><span class="co">## Sepal.Length                   0.16506    0.06017   2.743  0.00687 ** </span></span>
<span><span class="co">## Petal.Width                    0.44726    0.08833   5.064 1.25e-06 ***</span></span>
<span><span class="co">## Species_versicolor             0.29340    0.09839   2.982  0.00337 ** </span></span>
<span><span class="co">## Petal.Length                  -0.05916    0.15021  -0.394  0.69428    </span></span>
<span><span class="co">## `Sepal.Length:Species_setosa`  0.45943    0.09997   4.596 9.40e-06 ***</span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## (Dispersion parameter for gaussian family taken to be 0.06292687)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##     Null deviance: 28.3069  on 149  degrees of freedom</span></span>
<span><span class="co">## Residual deviance:  8.9985  on 143  degrees of freedom</span></span>
<span><span class="co">## AIC: 19.646</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Number of Fisher Scoring iterations: 2</span></span></code></pre></div>
<p>Alternatively, sample splitting can be utilized to achieve valid
inference. This method divides the data into two samples of equal size,
uses the first sample to select the model, and the second one to fit and
achieve valid (though potentially low-power) inference. Coefficients
which are not selected are bestowed a p-value of 1.</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">s1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sparseRBIC_sampsplit.html">sparseRBIC_sampsplit</a></span><span class="op">(</span><span class="va">rbic1</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Note: sparseRBIC_sampsplit is currently experimental and may not behave as expected.</span></span>
<span><span class="co">## Warning: `progress_estimated()` was deprecated in dplyr 1.0.0.</span></span>
<span><span class="co">## <span style="color: #00BBBB;">ℹ</span> The deprecated feature was likely used in the <span style="color: #0000BB;">sparseR</span> package.</span></span>
<span><span class="co">##   Please report the issue to the authors.</span></span>
<span><span class="co">## <span style="color: #555555;">This warning is displayed once every 8 hours.</span></span></span>
<span><span class="co">## <span style="color: #555555;">Call `lifecycle::last_lifecycle_warnings()` to see where this warning was</span></span></span>
<span><span class="co">## <span style="color: #555555;">generated.</span></span></span></code></pre>
<table class="table table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead><tr>
<th style="text-align:left;">
Coefficient
</th>
<th style="text-align:right;">
Median_p
</th>
<th style="text-align:right;">
Mean_p
</th>
<th style="text-align:right;">
Gmean_p
</th>
<th style="text-align:right;">
% selected
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
(Intercept)
</td>
<td style="text-align:right;">
0.00000
</td>
<td style="text-align:right;">
0.00000
</td>
<td style="text-align:right;">
0.00000
</td>
<td style="text-align:right;">
100
</td>
</tr>
<tr>
<td style="text-align:left;">
Species_setosa
</td>
<td style="text-align:right;">
0.00000
</td>
<td style="text-align:right;">
0.00000
</td>
<td style="text-align:right;">
0.00000
</td>
<td style="text-align:right;">
100
</td>
</tr>
<tr>
<td style="text-align:left;">
Sepal.Length
</td>
<td style="text-align:right;">
0.00003
</td>
<td style="text-align:right;">
0.11104
</td>
<td style="text-align:right;">
0.00007
</td>
<td style="text-align:right;">
90
</td>
</tr>
<tr>
<td style="text-align:left;">
Sepal.Length:Species_setosa
</td>
<td style="text-align:right;">
0.00870
</td>
<td style="text-align:right;">
0.30440
</td>
<td style="text-align:right;">
0.01235
</td>
<td style="text-align:right;">
70
</td>
</tr>
<tr>
<td style="text-align:left;">
Petal.Width
</td>
<td style="text-align:right;">
0.50777
</td>
<td style="text-align:right;">
0.50342
</td>
<td style="text-align:right;">
0.05012
</td>
<td style="text-align:right;">
50
</td>
</tr>
<tr>
<td style="text-align:left;">
Species_versicolor
</td>
<td style="text-align:right;">
1.00000
</td>
<td style="text-align:right;">
0.70857
</td>
<td style="text-align:right;">
0.24735
</td>
<td style="text-align:right;">
30
</td>
</tr>
<tr>
<td style="text-align:left;">
Petal.Length
</td>
<td style="text-align:right;">
1.00000
</td>
<td style="text-align:right;">
0.96673
</td>
<td style="text-align:right;">
0.96036
</td>
<td style="text-align:right;">
10
</td>
</tr>
<tr>
<td style="text-align:left;">
Species_virginica
</td>
<td style="text-align:right;">
1.00000
</td>
<td style="text-align:right;">
0.90080
</td>
<td style="text-align:right;">
0.61697
</td>
<td style="text-align:right;">
10
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">s2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sparseRBIC_sampsplit.html">sparseRBIC_sampsplit</a></span><span class="op">(</span><span class="va">rbic2</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Note: sparseRBIC_sampsplit is currently experimental and may not behave as expected.</span></span></code></pre>
<table class="table table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead><tr>
<th style="text-align:left;">
Coefficient
</th>
<th style="text-align:right;">
Median_p
</th>
<th style="text-align:right;">
Mean_p
</th>
<th style="text-align:right;">
Gmean_p
</th>
<th style="text-align:right;">
% selected
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
(Intercept)
</td>
<td style="text-align:right;">
0.04734
</td>
<td style="text-align:right;">
0.17159
</td>
<td style="text-align:right;">
0.02558
</td>
<td style="text-align:right;">
100
</td>
</tr>
<tr>
<td style="text-align:left;">
Species_setosa
</td>
<td style="text-align:right;">
0.13169
</td>
<td style="text-align:right;">
0.16987
</td>
<td style="text-align:right;">
0.01248
</td>
<td style="text-align:right;">
100
</td>
</tr>
<tr>
<td style="text-align:left;">
Sepal.Length
</td>
<td style="text-align:right;">
0.00063
</td>
<td style="text-align:right;">
0.00644
</td>
<td style="text-align:right;">
0.00008
</td>
<td style="text-align:right;">
100
</td>
</tr>
<tr>
<td style="text-align:left;">
Sepal.Length:Species_setosa
</td>
<td style="text-align:right;">
0.01678
</td>
<td style="text-align:right;">
0.20926
</td>
<td style="text-align:right;">
0.00805
</td>
<td style="text-align:right;">
80
</td>
</tr>
<tr>
<td style="text-align:left;">
Petal.Width
</td>
<td style="text-align:right;">
0.06679
</td>
<td style="text-align:right;">
0.41570
</td>
<td style="text-align:right;">
0.06695
</td>
<td style="text-align:right;">
60
</td>
</tr>
<tr>
<td style="text-align:left;">
Species_versicolor
</td>
<td style="text-align:right;">
1.00000
</td>
<td style="text-align:right;">
0.64032
</td>
<td style="text-align:right;">
0.37897
</td>
<td style="text-align:right;">
40
</td>
</tr>
<tr>
<td style="text-align:left;">
Petal.Width:Species_setosa
</td>
<td style="text-align:right;">
1.00000
</td>
<td style="text-align:right;">
0.92315
</td>
<td style="text-align:right;">
0.90718
</td>
<td style="text-align:right;">
20
</td>
</tr>
<tr>
<td style="text-align:left;">
Species_virginica
</td>
<td style="text-align:right;">
1.00000
</td>
<td style="text-align:right;">
0.90834
</td>
<td style="text-align:right;">
0.78000
</td>
<td style="text-align:right;">
10
</td>
</tr>
<tr>
<td style="text-align:left;">
Petal.Length
</td>
<td style="text-align:right;">
1.00000
</td>
<td style="text-align:right;">
0.98405
</td>
<td style="text-align:right;">
0.98277
</td>
<td style="text-align:right;">
10
</td>
</tr>
<tr>
<td style="text-align:left;">
Sepal.Length:Petal.Length
</td>
<td style="text-align:right;">
1.00000
</td>
<td style="text-align:right;">
0.93700
</td>
<td style="text-align:right;">
0.90536
</td>
<td style="text-align:right;">
10
</td>
</tr>
<tr>
<td style="text-align:left;">
Sepal.Length:Petal.Width
</td>
<td style="text-align:right;">
1.00000
</td>
<td style="text-align:right;">
0.90141
</td>
<td style="text-align:right;">
0.65295
</td>
<td style="text-align:right;">
10
</td>
</tr>
</tbody>
</table>
<p>Additionally, inferences based on bootstrapped samples of the data
are available via the <code>sparseRBIC_bootstrap</code> function, which
stores p-values for each coefficient after model selection has been
performed. If a coefficient has not been selected, the p-value is set to
one for that bootstrap iteration, so when the “mean” p-value is
calculated across bootstraps, the underestimation of the p-value due to
model selection is attenuated, as the estimate gets “pulled up” by the
1’s in the vector. Since this may be a conservative approach, we also
display the “geometric” mean which is a measure of central tendency less
sensitive to skew (which many p-values will be highly right skewed).
More research must be done on these techniques to ensure adequate
coverage properties, but given a high enough number of bootstrap samples
they should both be more conservative than the naive, “pretend model
selection never took place” approach. The downside here is that
depending on the size of the data and the number of variables, this
could take quite some time.</p>
<p>Note that the mean p-value across bootstraps is bounded to be greater
than 1-P(selected). In some sense, this makes sense, as if a variable
has a low probability of being selected, then that variable should have
a higher adjusted p-value. However, for variables whose effects will be
highly related (i.e. an interaction and a constituent main effect), this
may be too conservative.</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="co">## Centered model</span></span>
<span><span class="va">b1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sparseRBIC_bootstrap.html">sparseRBIC_bootstrap</a></span><span class="op">(</span><span class="va">rbic1</span><span class="op">)</span></span></code></pre></div>
<table class="table table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead><tr>
<th style="text-align:left;">
Coefficient
</th>
<th style="text-align:right;">
Mean_p
</th>
<th style="text-align:right;">
Gmean_p
</th>
<th style="text-align:right;">
% selected
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
(Intercept)
</td>
<td style="text-align:right;">
0.00000
</td>
<td style="text-align:right;">
0.00000
</td>
<td style="text-align:right;">
100
</td>
</tr>
<tr>
<td style="text-align:left;">
Species_setosa
</td>
<td style="text-align:right;">
0.00000
</td>
<td style="text-align:right;">
0.00000
</td>
<td style="text-align:right;">
100
</td>
</tr>
<tr>
<td style="text-align:left;">
Sepal.Length
</td>
<td style="text-align:right;">
0.00293
</td>
<td style="text-align:right;">
0.00000
</td>
<td style="text-align:right;">
100
</td>
</tr>
<tr>
<td style="text-align:left;">
Sepal.Length:Species_setosa
</td>
<td style="text-align:right;">
0.20011
</td>
<td style="text-align:right;">
0.00002
</td>
<td style="text-align:right;">
80
</td>
</tr>
<tr>
<td style="text-align:left;">
Petal.Width
</td>
<td style="text-align:right;">
0.50000
</td>
<td style="text-align:right;">
0.00008
</td>
<td style="text-align:right;">
50
</td>
</tr>
<tr>
<td style="text-align:left;">
Species_virginica
</td>
<td style="text-align:right;">
0.90004
</td>
<td style="text-align:right;">
0.46242
</td>
<td style="text-align:right;">
10
</td>
</tr>
<tr>
<td style="text-align:left;">
Petal.Length
</td>
<td style="text-align:right;">
0.81087
</td>
<td style="text-align:right;">
0.54467
</td>
<td style="text-align:right;">
20
</td>
</tr>
<tr>
<td style="text-align:left;">
Species_versicolor
</td>
<td style="text-align:right;">
0.70005
</td>
<td style="text-align:right;">
0.03516
</td>
<td style="text-align:right;">
30
</td>
</tr>
<tr>
<td style="text-align:left;">
Sepal.Length:Petal.Width
</td>
<td style="text-align:right;">
0.90000
</td>
<td style="text-align:right;">
0.32270
</td>
<td style="text-align:right;">
10
</td>
</tr>
<tr>
<td style="text-align:left;">
Sepal.Length:Species_versicolor
</td>
<td style="text-align:right;">
0.90222
</td>
<td style="text-align:right;">
0.68331
</td>
<td style="text-align:right;">
10
</td>
</tr>
<tr>
<td style="text-align:left;">
Petal.Width:Species_setosa
</td>
<td style="text-align:right;">
0.90182
</td>
<td style="text-align:right;">
0.66977
</td>
<td style="text-align:right;">
10
</td>
</tr>
<tr>
<td style="text-align:left;">
Sepal.Length:Petal.Length
</td>
<td style="text-align:right;">
0.90000
</td>
<td style="text-align:right;">
0.22450
</td>
<td style="text-align:right;">
10
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="co">## Uncentered model</span></span>
<span><span class="va">b2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sparseRBIC_bootstrap.html">sparseRBIC_bootstrap</a></span><span class="op">(</span><span class="va">rbic2</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Note: sparseRBIC_bootstrap is currently experimental and may not behave as expected.</span></span></code></pre>
<table class="table table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead><tr>
<th style="text-align:left;">
Coefficient
</th>
<th style="text-align:right;">
Mean_p
</th>
<th style="text-align:right;">
Gmean_p
</th>
<th style="text-align:right;">
% selected
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
(Intercept)
</td>
<td style="text-align:right;">
0.16409
</td>
<td style="text-align:right;">
0.00012
</td>
<td style="text-align:right;">
100
</td>
</tr>
<tr>
<td style="text-align:left;">
Species_setosa
</td>
<td style="text-align:right;">
0.08507
</td>
<td style="text-align:right;">
0.00002
</td>
<td style="text-align:right;">
100
</td>
</tr>
<tr>
<td style="text-align:left;">
Sepal.Length
</td>
<td style="text-align:right;">
0.00293
</td>
<td style="text-align:right;">
0.00000
</td>
<td style="text-align:right;">
100
</td>
</tr>
<tr>
<td style="text-align:left;">
Sepal.Length:Species_setosa
</td>
<td style="text-align:right;">
0.20011
</td>
<td style="text-align:right;">
0.00002
</td>
<td style="text-align:right;">
80
</td>
</tr>
<tr>
<td style="text-align:left;">
Petal.Width
</td>
<td style="text-align:right;">
0.50000
</td>
<td style="text-align:right;">
0.00019
</td>
<td style="text-align:right;">
50
</td>
</tr>
<tr>
<td style="text-align:left;">
Species_versicolor
</td>
<td style="text-align:right;">
0.70005
</td>
<td style="text-align:right;">
0.03467
</td>
<td style="text-align:right;">
30
</td>
</tr>
<tr>
<td style="text-align:left;">
Petal.Length
</td>
<td style="text-align:right;">
0.80063
</td>
<td style="text-align:right;">
0.31402
</td>
<td style="text-align:right;">
20
</td>
</tr>
<tr>
<td style="text-align:left;">
Species_virginica
</td>
<td style="text-align:right;">
0.90002
</td>
<td style="text-align:right;">
0.42012
</td>
<td style="text-align:right;">
10
</td>
</tr>
<tr>
<td style="text-align:left;">
Sepal.Length:Petal.Width
</td>
<td style="text-align:right;">
0.90000
</td>
<td style="text-align:right;">
0.21649
</td>
<td style="text-align:right;">
10
</td>
</tr>
<tr>
<td style="text-align:left;">
Sepal.Length:Species_virginica
</td>
<td style="text-align:right;">
0.90005
</td>
<td style="text-align:right;">
0.46330
</td>
<td style="text-align:right;">
10
</td>
</tr>
<tr>
<td style="text-align:left;">
Petal.Width:Species_setosa
</td>
<td style="text-align:right;">
0.80266
</td>
<td style="text-align:right;">
0.41523
</td>
<td style="text-align:right;">
20
</td>
</tr>
<tr>
<td style="text-align:left;">
Sepal.Length:Petal.Length
</td>
<td style="text-align:right;">
0.90000
</td>
<td style="text-align:right;">
0.22450
</td>
<td style="text-align:right;">
10
</td>
</tr>
</tbody>
</table>
<p>This section is still under development.</p>
</div>
</div>
<div class="section level2">
<h2 id="use-case-lung-data">Use case: lung data<a class="anchor" aria-label="anchor" href="#use-case-lung-data"></a>
</h2>
<div class="section level3">
<h3 id="data-set-description-1">Data set description<a class="anchor" aria-label="anchor" href="#data-set-description-1"></a>
</h3>
<p>As a more realistic example, we take a data set that is often used to
train models that can predict lung cancer status. It has 1027
observations and 14 covariates, including urban/rural, age, years of
school, smoking years, number of children, etc.</p>
<p>First, let’s look at the data a little:</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"irlcs_radon_syn"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">irlcs_radon_syn</span><span class="op">)</span></span>
<span><span class="co">##        ID         CITY       YRSHOME          AGE        CASE    SCHOOL </span></span>
<span><span class="co">##  Min.   :   1.0   0:246   Min.   :20.0   Min.   :44.16   0:632   1: 92  </span></span>
<span><span class="co">##  1st Qu.: 260.5   1:781   1st Qu.:25.0   1st Qu.:61.38   1:395   2:506  </span></span>
<span><span class="co">##  Median : 492.0           Median :31.0   Median :67.84           3:293  </span></span>
<span><span class="co">##  Mean   : 505.2           Mean   :33.1   Mean   :67.45           4:106  </span></span>
<span><span class="co">##  3rd Qu.: 761.0           3rd Qu.:39.0   3rd Qu.:73.82           5: 30  </span></span>
<span><span class="co">##  Max.   :1026.0           Max.   :75.0   Max.   :84.80                  </span></span>
<span><span class="co">##                                                                         </span></span>
<span><span class="co">##      SMKYRS         CHILDREN           PYR            PYRRATE       </span></span>
<span><span class="co">##  Min.   : 0.00   Min.   : 0.000   Min.   :  0.00   Min.   :0.00000  </span></span>
<span><span class="co">##  1st Qu.: 0.00   1st Qu.: 2.000   1st Qu.:  0.00   1st Qu.:0.00000  </span></span>
<span><span class="co">##  Median :13.00   Median : 3.000   Median :  3.60   Median :0.05368  </span></span>
<span><span class="co">##  Mean   :20.58   Mean   : 3.065   Mean   : 19.31   Mean   :0.31745  </span></span>
<span><span class="co">##  3rd Qu.:41.00   3rd Qu.: 4.000   3rd Qu.: 35.07   3rd Qu.:0.58024  </span></span>
<span><span class="co">##  Max.   :64.00   Max.   :13.000   Max.   :138.45   Max.   :2.55702  </span></span>
<span><span class="co">##                                                                     </span></span>
<span><span class="co">##     SMKQUIT            BMI            WLM20        PRELUNG SMKEVER SMKCUR </span></span>
<span><span class="co">##  Min.   : 0.000   Min.   :16.64   Min.   : 2.176   0:692   0:476   0:705  </span></span>
<span><span class="co">##  1st Qu.: 0.000   1st Qu.:21.79   1st Qu.: 5.902   1:335   1:551   1:322  </span></span>
<span><span class="co">##  Median : 0.000   Median :23.78   Median : 8.683                          </span></span>
<span><span class="co">##  Mean   : 4.733   Mean   :24.60   Mean   :10.914                          </span></span>
<span><span class="co">##  3rd Qu.: 3.325   3rd Qu.:27.40   3rd Qu.:13.246                          </span></span>
<span><span class="co">##  Max.   :57.355   Max.   :41.60   Max.   :77.457                          </span></span>
<span><span class="co">##                   NA's   :51</span></span></code></pre></div>
<p>Note:</p>
<ul>
<li>There are missing values for BMI - we will see how
<code>sparseR</code> handles this.</li>
<li>Everything is coded as numeric except the outcome, case (this is not
necessary for <code>sparseR</code> to work), as we will see.</li>
<li>
<code>ID</code> is an arbitrary identifying variable which should
not be used in the modeling phase</li>
</ul>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">irlcs_radon_syn</span> <span class="op">&lt;-</span> <span class="fu">select</span><span class="op">(</span><span class="va">irlcs_radon_syn</span>, <span class="op">-</span><span class="va">ID</span><span class="op">)</span></span></code></pre></div>
<p>At this point, we will split the data into a test and training
set.</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">13</span><span class="op">)</span></span>
<span></span>
<span><span class="va">N</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">irlcs_radon_syn</span><span class="op">)</span></span>
<span><span class="va">trainIDX</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">N</span>, <span class="va">N</span> <span class="op">*</span> <span class="fl">.75</span><span class="op">)</span></span>
<span><span class="va">train</span> <span class="op">&lt;-</span> <span class="va">irlcs_radon_syn</span><span class="op">[</span><span class="va">trainIDX</span>,<span class="op">]</span></span>
<span><span class="va">test</span> <span class="op">&lt;-</span> <span class="va">irlcs_radon_syn</span><span class="op">[</span><span class="op">-</span><span class="va">trainIDX</span>,<span class="op">]</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="preprocessing">Preprocessing<a class="anchor" aria-label="anchor" href="#preprocessing"></a>
</h3>
<p>Although the <code><a href="../reference/sparseR.html">sparseR()</a></code> function will do it
automatically, it’s generally a good idea to see how the data is being
preprocessed and to examine how the model matrix is built before the
regularization. We can see what <code>sparseR</code> does to preprocess
the data by running the function <code>sparseR_prep</code>, which
utilizes the <code>recipes</code> package to perform preprocessing. At
no time is the outcome used to train any of the steps, except for the
elimination of NA values if any exist.</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">prep_obj</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sparseR_prep.html">sparseR_prep</a></span><span class="op">(</span><span class="va">CASE</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">train</span>, k <span class="op">=</span> <span class="fl">0</span>, poly <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">prep_obj</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## <span style="color: #00BBBB;">──</span> <span style="font-weight: bold;">Recipe</span> <span style="color: #00BBBB;">──────────────────────────────────────────────────────────────────────</span></span></span>
<span><span class="co">## </span></span>
<span><span class="co">## ── Inputs</span></span>
<span><span class="co">## Number of variables by role</span></span>
<span><span class="co">## outcome:    1</span></span>
<span><span class="co">## predictor: 10</span></span>
<span><span class="co">## dummy:      4</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## ── Training information</span></span>
<span><span class="co">## Training data contained 770 data points and 43 incomplete rows.</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## ── Operations</span></span>
<span><span class="co">## <span style="color: #00BBBB;">•</span> Variables removed: <span style="color: #0000BB;">&lt;none&gt;</span> | <span style="font-style: italic;">Trained</span></span></span>
<span><span class="co">## <span style="color: #00BBBB;">•</span> Sparse, unbalanced variable filter removed: <span style="color: #0000BB;">&lt;none&gt;</span> | <span style="font-style: italic;">Trained</span></span></span>
<span><span class="co">## <span style="color: #00BBBB;">•</span> Scaling for: <span style="color: #0000BB;">YRSHOME</span>, <span style="color: #0000BB;">AGE</span>, <span style="color: #0000BB;">SMKYRS</span>, <span style="color: #0000BB;">CHILDREN</span>, <span style="color: #0000BB;">PYR</span>, <span style="color: #0000BB;">PYRRATE</span>, ... | <span style="font-style: italic;">Trained</span></span></span>
<span><span class="co">## <span style="color: #00BBBB;">•</span> Collapsing factor levels for: <span style="color: #0000BB;">SCHOOL</span> | <span style="font-style: italic;">Trained</span></span></span>
<span><span class="co">## <span style="color: #00BBBB;">•</span> K-nearest neighbor imputation for: <span style="color: #0000BB;">YRSHOME</span>, <span style="color: #0000BB;">AGE</span>, <span style="color: #0000BB;">SCHOOL</span>, ... | <span style="font-style: italic;">Trained</span></span></span>
<span><span class="co">## <span style="color: #00BBBB;">•</span> Removing rows with NA values in: <span style="color: #0000BB;">CITY</span>, <span style="color: #0000BB;">YRSHOME</span>, <span style="color: #0000BB;">AGE</span>, <span style="color: #0000BB;">SCHOOL</span>, ... | <span style="font-style: italic;">Trained</span></span></span>
<span><span class="co">## <span style="color: #00BBBB;">•</span> Variables removed: <span style="color: #0000BB;">CASE</span> | <span style="font-style: italic;">Trained</span></span></span>
<span><span class="co">## <span style="color: #00BBBB;">•</span> Dummy variables from: <span style="color: #0000BB;">CITY</span>, <span style="color: #0000BB;">SCHOOL</span>, <span style="color: #0000BB;">PRELUNG</span>, <span style="color: #0000BB;">SMKEVER</span>, <span style="color: #0000BB;">SMKCUR</span> | <span style="font-style: italic;">Trained</span></span></span>
<span><span class="co">## <span style="color: #00BBBB;">•</span> Sparse, unbalanced variable filter removed: <span style="color: #0000BB;">SCHOOL_other</span> | <span style="font-style: italic;">Trained</span></span></span>
<span><span class="co">## Centering to mean for YRSHOME, AGE, SMKYRS, CHILDREN, PYR, PYRRATE, S... [trained]</span></span></code></pre></div>
<p>We see that the preprocessor did many things, among which it imputed
the data for the missing value using the other predictors in the model.
Apparently, by default, this preprocessor will remove variables with
“near” zero variance, and that as a result, SMKYRS is not considered
(it’s eliminated in an early step).</p>
<p>If we look at this variable, we see that it may be informative:</p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">MASS</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/MASS/man/truehist.html" class="external-link">truehist</a></span><span class="op">(</span><span class="va">train</span><span class="op">$</span><span class="va">SMKYRS</span><span class="op">)</span></span></code></pre></div>
<p><img src="sparseR_files/figure-html/unnamed-chunk-41-1.png" width="672"></p>
<p>Therefore, we can tell the preprocessor not to filter this variable
in two ways. First, we could tell it to use <code>zv</code> instead of
<code>nzv</code>, in which case it will only remove zero variance
predictors:</p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/sparseR_prep.html">sparseR_prep</a></span><span class="op">(</span><span class="va">CASE</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">train</span>, k <span class="op">=</span> <span class="fl">0</span>, poly <span class="op">=</span> <span class="fl">1</span>, filter <span class="op">=</span> <span class="st">"zv"</span><span class="op">)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## <span style="color: #00BBBB;">──</span> <span style="font-weight: bold;">Recipe</span> <span style="color: #00BBBB;">──────────────────────────────────────────────────────────────────────</span></span></span>
<span><span class="co">## </span></span>
<span><span class="co">## ── Inputs</span></span>
<span><span class="co">## Number of variables by role</span></span>
<span><span class="co">## outcome:    1</span></span>
<span><span class="co">## predictor: 10</span></span>
<span><span class="co">## dummy:      4</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## ── Training information</span></span>
<span><span class="co">## Training data contained 770 data points and 43 incomplete rows.</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## ── Operations</span></span>
<span><span class="co">## <span style="color: #00BBBB;">•</span> Variables removed: <span style="color: #0000BB;">&lt;none&gt;</span> | <span style="font-style: italic;">Trained</span></span></span>
<span><span class="co">## <span style="color: #00BBBB;">•</span> Zero variance filter removed: <span style="color: #0000BB;">&lt;none&gt;</span> | <span style="font-style: italic;">Trained</span></span></span>
<span><span class="co">## Centering to mean for YRSHOME, AGE, SMKYRS, CHILDREN, PYR, PYRRATE, S... [trained]</span></span>
<span><span class="co">## <span style="color: #00BBBB;">•</span> Scaling for: <span style="color: #0000BB;">YRSHOME</span>, <span style="color: #0000BB;">AGE</span>, <span style="color: #0000BB;">SMKYRS</span>, <span style="color: #0000BB;">CHILDREN</span>, <span style="color: #0000BB;">PYR</span>, <span style="color: #0000BB;">PYRRATE</span>, ... | <span style="font-style: italic;">Trained</span></span></span>
<span><span class="co">## <span style="color: #00BBBB;">•</span> Collapsing factor levels for: <span style="color: #0000BB;">SCHOOL</span> | <span style="font-style: italic;">Trained</span></span></span>
<span><span class="co">## <span style="color: #00BBBB;">•</span> K-nearest neighbor imputation for: <span style="color: #0000BB;">YRSHOME</span>, <span style="color: #0000BB;">AGE</span>, <span style="color: #0000BB;">SCHOOL</span>, ... | <span style="font-style: italic;">Trained</span></span></span>
<span><span class="co">## <span style="color: #00BBBB;">•</span> Removing rows with NA values in: <span style="color: #0000BB;">CITY</span>, <span style="color: #0000BB;">YRSHOME</span>, <span style="color: #0000BB;">AGE</span>, <span style="color: #0000BB;">SCHOOL</span>, ... | <span style="font-style: italic;">Trained</span></span></span>
<span><span class="co">## <span style="color: #00BBBB;">•</span> Variables removed: <span style="color: #0000BB;">CASE</span> | <span style="font-style: italic;">Trained</span></span></span>
<span><span class="co">## <span style="color: #00BBBB;">•</span> Dummy variables from: <span style="color: #0000BB;">CITY</span>, <span style="color: #0000BB;">SCHOOL</span>, <span style="color: #0000BB;">PRELUNG</span>, <span style="color: #0000BB;">SMKEVER</span>, <span style="color: #0000BB;">SMKCUR</span> | <span style="font-style: italic;">Trained</span></span></span>
<span><span class="co">## <span style="color: #00BBBB;">•</span> Zero variance filter removed: <span style="color: #0000BB;">&lt;none&gt;</span> | <span style="font-style: italic;">Trained</span></span></span></code></pre></div>
<p>Or, we could adjust the options for the near-zero variance filter
(see <code><a href="https://recipes.tidymodels.org/reference/step_nzv.html" class="external-link">?recipes::step_nzv</a></code> for details):</p>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/sparseR_prep.html">sparseR_prep</a></span><span class="op">(</span><span class="va">CASE</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">train</span>, k <span class="op">=</span> <span class="fl">0</span>, poly <span class="op">=</span> <span class="fl">1</span>, extra_opts <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>unique_cut <span class="op">=</span> <span class="fl">5</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## <span style="color: #00BBBB;">──</span> <span style="font-weight: bold;">Recipe</span> <span style="color: #00BBBB;">──────────────────────────────────────────────────────────────────────</span></span></span>
<span><span class="co">## </span></span>
<span><span class="co">## ── Inputs</span></span>
<span><span class="co">## Number of variables by role</span></span>
<span><span class="co">## outcome:    1</span></span>
<span><span class="co">## predictor: 10</span></span>
<span><span class="co">## dummy:      4</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## ── Training information</span></span>
<span><span class="co">## Training data contained 770 data points and 43 incomplete rows.</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## ── Operations</span></span>
<span><span class="co">## <span style="color: #00BBBB;">•</span> Variables removed: <span style="color: #0000BB;">&lt;none&gt;</span> | <span style="font-style: italic;">Trained</span></span></span>
<span><span class="co">## <span style="color: #00BBBB;">•</span> Sparse, unbalanced variable filter removed: <span style="color: #0000BB;">&lt;none&gt;</span> | <span style="font-style: italic;">Trained</span></span></span>
<span><span class="co">## Centering to mean for YRSHOME, AGE, SMKYRS, CHILDREN, PYR, PYRRATE, S... [trained]</span></span>
<span><span class="co">## <span style="color: #00BBBB;">•</span> Scaling for: <span style="color: #0000BB;">YRSHOME</span>, <span style="color: #0000BB;">AGE</span>, <span style="color: #0000BB;">SMKYRS</span>, <span style="color: #0000BB;">CHILDREN</span>, <span style="color: #0000BB;">PYR</span>, <span style="color: #0000BB;">PYRRATE</span>, ... | <span style="font-style: italic;">Trained</span></span></span>
<span><span class="co">## <span style="color: #00BBBB;">•</span> Collapsing factor levels for: <span style="color: #0000BB;">SCHOOL</span> | <span style="font-style: italic;">Trained</span></span></span>
<span><span class="co">## <span style="color: #00BBBB;">•</span> K-nearest neighbor imputation for: <span style="color: #0000BB;">YRSHOME</span>, <span style="color: #0000BB;">AGE</span>, <span style="color: #0000BB;">SCHOOL</span>, ... | <span style="font-style: italic;">Trained</span></span></span>
<span><span class="co">## <span style="color: #00BBBB;">•</span> Removing rows with NA values in: <span style="color: #0000BB;">CITY</span>, <span style="color: #0000BB;">YRSHOME</span>, <span style="color: #0000BB;">AGE</span>, <span style="color: #0000BB;">SCHOOL</span>, ... | <span style="font-style: italic;">Trained</span></span></span>
<span><span class="co">## <span style="color: #00BBBB;">•</span> Variables removed: <span style="color: #0000BB;">CASE</span> | <span style="font-style: italic;">Trained</span></span></span>
<span><span class="co">## <span style="color: #00BBBB;">•</span> Dummy variables from: <span style="color: #0000BB;">CITY</span>, <span style="color: #0000BB;">SCHOOL</span>, <span style="color: #0000BB;">PRELUNG</span>, <span style="color: #0000BB;">SMKEVER</span>, <span style="color: #0000BB;">SMKCUR</span> | <span style="font-style: italic;">Trained</span></span></span>
<span><span class="co">## <span style="color: #00BBBB;">•</span> Sparse, unbalanced variable filter removed: <span style="color: #0000BB;">SCHOOL_other</span> | <span style="font-style: italic;">Trained</span></span></span></code></pre></div>
<p>Notice that we haven’t told the preprocessor to build any
interactions or polynomials of higher degree than 1. we can do this
simply by setting <code>k</code> and <code>poly</code> respectively to
higher numbers:</p>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/sparseR_prep.html">sparseR_prep</a></span><span class="op">(</span><span class="va">CASE</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">train</span>, k <span class="op">=</span> <span class="fl">1</span>, poly <span class="op">=</span> <span class="fl">1</span>, extra_opts <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>unique_cut <span class="op">=</span> <span class="fl">5</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## <span style="color: #00BBBB;">──</span> <span style="font-weight: bold;">Recipe</span> <span style="color: #00BBBB;">──────────────────────────────────────────────────────────────────────</span></span></span>
<span><span class="co">## </span></span>
<span><span class="co">## ── Inputs</span></span>
<span><span class="co">## Number of variables by role</span></span>
<span><span class="co">## outcome:    1</span></span>
<span><span class="co">## predictor: 10</span></span>
<span><span class="co">## dummy:      4</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## ── Training information</span></span>
<span><span class="co">## Training data contained 770 data points and 43 incomplete rows.</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## ── Operations</span></span>
<span><span class="co">## <span style="color: #00BBBB;">•</span> Variables removed: <span style="color: #0000BB;">&lt;none&gt;</span> | <span style="font-style: italic;">Trained</span></span></span>
<span><span class="co">## <span style="color: #00BBBB;">•</span> Sparse, unbalanced variable filter removed: <span style="color: #0000BB;">&lt;none&gt;</span> | <span style="font-style: italic;">Trained</span></span></span>
<span><span class="co">## Centering to mean for YRSHOME, AGE, SMKYRS, CHILDREN, PYR, PYRRATE, S... [trained]</span></span>
<span><span class="co">## <span style="color: #00BBBB;">•</span> Scaling for: <span style="color: #0000BB;">YRSHOME</span>, <span style="color: #0000BB;">AGE</span>, <span style="color: #0000BB;">SMKYRS</span>, <span style="color: #0000BB;">CHILDREN</span>, <span style="color: #0000BB;">PYR</span>, <span style="color: #0000BB;">PYRRATE</span>, ... | <span style="font-style: italic;">Trained</span></span></span>
<span><span class="co">## <span style="color: #00BBBB;">•</span> Collapsing factor levels for: <span style="color: #0000BB;">SCHOOL</span> | <span style="font-style: italic;">Trained</span></span></span>
<span><span class="co">## <span style="color: #00BBBB;">•</span> K-nearest neighbor imputation for: <span style="color: #0000BB;">YRSHOME</span>, <span style="color: #0000BB;">AGE</span>, <span style="color: #0000BB;">SCHOOL</span>, ... | <span style="font-style: italic;">Trained</span></span></span>
<span><span class="co">## <span style="color: #00BBBB;">•</span> Removing rows with NA values in: <span style="color: #0000BB;">CITY</span>, <span style="color: #0000BB;">YRSHOME</span>, <span style="color: #0000BB;">AGE</span>, <span style="color: #0000BB;">SCHOOL</span>, ... | <span style="font-style: italic;">Trained</span></span></span>
<span><span class="co">## <span style="color: #00BBBB;">•</span> Variables removed: <span style="color: #0000BB;">CASE</span> | <span style="font-style: italic;">Trained</span></span></span>
<span><span class="co">## <span style="color: #00BBBB;">•</span> Dummy variables from: <span style="color: #0000BB;">CITY</span>, <span style="color: #0000BB;">SCHOOL</span>, <span style="color: #0000BB;">PRELUNG</span>, <span style="color: #0000BB;">SMKEVER</span>, <span style="color: #0000BB;">SMKCUR</span> | <span style="font-style: italic;">Trained</span></span></span>
<span><span class="co">## <span style="color: #00BBBB;">•</span> Interactions with: <span style="color: #0000BB;">(YRSHOME + AGE + SMKYRS + CHILDREN + PYR + PYRRATE +</span></span></span>
<span><span class="co">##   <span style="color: #0000BB;">SMKQUIT + BMI + WLM20 + (CITY_X0 + CITY_X1 + SCHOOL_X1 + SCHOOL_X2 +</span></span></span>
<span><span class="co">##   <span style="color: #0000BB;">SCHOOL_X3 + SCHOOL_X4 + SCHOOL_other + PRELUNG_X0 + PRELUNG_X1 + SMKEVER_X0 +</span></span></span>
<span><span class="co">##   <span style="color: #0000BB;">SMKEVER_X1 + SMKCUR_X0 + SMKCUR_X1)) * (YRSHOME + AGE + SMKYRS + CHILDREN +</span></span></span>
<span><span class="co">##   <span style="color: #0000BB;">PYR + PYRRATE + SMKQUIT + BMI + WLM20 + (CITY_X0 + CITY_X1 + SCHOOL_X1 +</span></span></span>
<span><span class="co">##   <span style="color: #0000BB;">SCHOOL_X2 + SCHOOL_X3 + SCHOOL_X4 + SCHOOL_other + PRELUNG_X0 + PRELUNG_X1 +</span></span></span>
<span><span class="co">##   <span style="color: #0000BB;">SMKEVER_X0 + SMKEVER_X1 + SMKCUR_X0 + SMKCUR_X1))</span> | <span style="font-style: italic;">Trained</span></span></span>
<span><span class="co">## <span style="color: #00BBBB;">•</span> Sparse, unbalanced variable filter removed: <span style="color: #0000BB;">SCHOOL_other</span>, ... | <span style="font-style: italic;">Trained</span></span></span>
<span><span class="fu"><a href="../reference/sparseR_prep.html">sparseR_prep</a></span><span class="op">(</span><span class="va">CASE</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">train</span>, k <span class="op">=</span> <span class="fl">1</span>, poly <span class="op">=</span> <span class="fl">2</span>, extra_opts <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>unique_cut <span class="op">=</span> <span class="fl">5</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## <span style="color: #00BBBB;">──</span> <span style="font-weight: bold;">Recipe</span> <span style="color: #00BBBB;">──────────────────────────────────────────────────────────────────────</span></span></span>
<span><span class="co">## </span></span>
<span><span class="co">## ── Inputs</span></span>
<span><span class="co">## Number of variables by role</span></span>
<span><span class="co">## outcome:    1</span></span>
<span><span class="co">## predictor: 10</span></span>
<span><span class="co">## dummy:      4</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## ── Training information</span></span>
<span><span class="co">## Training data contained 770 data points and 43 incomplete rows.</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## ── Operations</span></span>
<span><span class="co">## <span style="color: #00BBBB;">•</span> Variables removed: <span style="color: #0000BB;">&lt;none&gt;</span> | <span style="font-style: italic;">Trained</span></span></span>
<span><span class="co">## <span style="color: #00BBBB;">•</span> Sparse, unbalanced variable filter removed: <span style="color: #0000BB;">&lt;none&gt;</span> | <span style="font-style: italic;">Trained</span></span></span>
<span><span class="co">## Centering to mean for YRSHOME, AGE, SMKYRS, CHILDREN, PYR, PYRRATE, S... [trained]</span></span>
<span><span class="co">## <span style="color: #00BBBB;">•</span> Scaling for: <span style="color: #0000BB;">YRSHOME</span>, <span style="color: #0000BB;">AGE</span>, <span style="color: #0000BB;">SMKYRS</span>, <span style="color: #0000BB;">CHILDREN</span>, <span style="color: #0000BB;">PYR</span>, <span style="color: #0000BB;">PYRRATE</span>, ... | <span style="font-style: italic;">Trained</span></span></span>
<span><span class="co">## <span style="color: #00BBBB;">•</span> Collapsing factor levels for: <span style="color: #0000BB;">SCHOOL</span> | <span style="font-style: italic;">Trained</span></span></span>
<span><span class="co">## <span style="color: #00BBBB;">•</span> K-nearest neighbor imputation for: <span style="color: #0000BB;">YRSHOME</span>, <span style="color: #0000BB;">AGE</span>, <span style="color: #0000BB;">SCHOOL</span>, ... | <span style="font-style: italic;">Trained</span></span></span>
<span><span class="co">## <span style="color: #00BBBB;">•</span> Removing rows with NA values in: <span style="color: #0000BB;">CITY</span>, <span style="color: #0000BB;">YRSHOME</span>, <span style="color: #0000BB;">AGE</span>, <span style="color: #0000BB;">SCHOOL</span>, ... | <span style="font-style: italic;">Trained</span></span></span>
<span><span class="co">## <span style="color: #00BBBB;">•</span> Variables removed: <span style="color: #0000BB;">CASE</span> | <span style="font-style: italic;">Trained</span></span></span>
<span><span class="co">## <span style="color: #00BBBB;">•</span> Dummy variables from: <span style="color: #0000BB;">CITY</span>, <span style="color: #0000BB;">SCHOOL</span>, <span style="color: #0000BB;">PRELUNG</span>, <span style="color: #0000BB;">SMKEVER</span>, <span style="color: #0000BB;">SMKCUR</span> | <span style="font-style: italic;">Trained</span></span></span>
<span><span class="co">## <span style="color: #00BBBB;">•</span> Interactions with: <span style="color: #0000BB;">(YRSHOME + AGE + SMKYRS + CHILDREN + PYR + PYRRATE +</span></span></span>
<span><span class="co">##   <span style="color: #0000BB;">SMKQUIT + BMI + WLM20 + (CITY_X0 + CITY_X1 + SCHOOL_X1 + SCHOOL_X2 +</span></span></span>
<span><span class="co">##   <span style="color: #0000BB;">SCHOOL_X3 + SCHOOL_X4 + SCHOOL_other + PRELUNG_X0 + PRELUNG_X1 + SMKEVER_X0 +</span></span></span>
<span><span class="co">##   <span style="color: #0000BB;">SMKEVER_X1 + SMKCUR_X0 + SMKCUR_X1)) * (YRSHOME + AGE + SMKYRS + CHILDREN +</span></span></span>
<span><span class="co">##   <span style="color: #0000BB;">PYR + PYRRATE + SMKQUIT + BMI + WLM20 + (CITY_X0 + CITY_X1 + SCHOOL_X1 +</span></span></span>
<span><span class="co">##   <span style="color: #0000BB;">SCHOOL_X2 + SCHOOL_X3 + SCHOOL_X4 + SCHOOL_other + PRELUNG_X0 + PRELUNG_X1 +</span></span></span>
<span><span class="co">##   <span style="color: #0000BB;">SMKEVER_X0 + SMKEVER_X1 + SMKCUR_X0 + SMKCUR_X1))</span> | <span style="font-style: italic;">Trained</span></span></span>
<span><span class="co">## <span style="color: #00BBBB;">•</span> Orthogonal polynomials on: <span style="color: #0000BB;">YRSHOME</span>, <span style="color: #0000BB;">AGE</span>, <span style="color: #0000BB;">SMKYRS</span>, <span style="color: #0000BB;">CHILDREN</span>, ... | <span style="font-style: italic;">Trained</span></span></span>
<span><span class="co">## <span style="color: #00BBBB;">•</span> Sparse, unbalanced variable filter removed: <span style="color: #0000BB;">SCHOOL_other</span>, ... | <span style="font-style: italic;">Trained</span></span></span></code></pre></div>
<p><em>Note</em>: This preprocessor does not actually produce any data,
it only prepares all of the steps. In the recipes package, this is known
as <code>prep</code>ping the processor. the final step is called
<code>bake</code>, where the data is fed through the processor and a new
data set is returned.</p>
</div>
<div class="section level3">
<h3 id="using-the-sparser-function">Using the <code>sparseR</code> function<a class="anchor" aria-label="anchor" href="#using-the-sparser-function"></a>
</h3>
<p>All of the preprocessing options can be accomplished through the main
function for the package, <code>sparseR</code>. The following code runs
a SRL model, an APL model, a main effects model, and an SRL with
polynomials:</p>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">lso</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  SRL  <span class="op">=</span> <span class="fu"><a href="../reference/sparseR.html">sparseR</a></span><span class="op">(</span><span class="va">CASE</span> <span class="op">~</span> <span class="va">.</span>, <span class="va">train</span>, seed <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,            <span class="co">## SRL model</span></span>
<span>  APL  <span class="op">=</span> <span class="fu"><a href="../reference/sparseR.html">sparseR</a></span><span class="op">(</span><span class="va">CASE</span> <span class="op">~</span> <span class="va">.</span>, <span class="va">train</span>, seed <span class="op">=</span> <span class="fl">1</span>, gamma <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>, <span class="co">## APL model</span></span>
<span>  ME   <span class="op">=</span> <span class="fu"><a href="../reference/sparseR.html">sparseR</a></span><span class="op">(</span><span class="va">CASE</span> <span class="op">~</span> <span class="va">.</span>, <span class="va">train</span>, seed <span class="op">=</span> <span class="fl">1</span>, k <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>,     <span class="co">## Main effects model</span></span>
<span>  SRLp <span class="op">=</span> <span class="fu"><a href="../reference/sparseR.html">sparseR</a></span><span class="op">(</span><span class="va">CASE</span> <span class="op">~</span> <span class="va">.</span>, <span class="va">train</span>, seed <span class="op">=</span> <span class="fl">1</span>, poly <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>   <span class="co">## SRL + polynomials</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>The simple print method allows one to investigate all of these
models</p>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">lso</span></span>
<span><span class="co">## $SRL</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Model summary @ min CV:</span></span>
<span><span class="co">## -----------------------------------------------------</span></span>
<span><span class="co">##   lasso-penalized linear regression with n=770, p=204</span></span>
<span><span class="co">##   (At lambda=0.0009):</span></span>
<span><span class="co">##     Nonzero coefficients: 41</span></span>
<span><span class="co">##     Cross-validation error (deviance): 0.13</span></span>
<span><span class="co">##     R-squared: 0.43</span></span>
<span><span class="co">##     Signal-to-noise ratio: 0.75</span></span>
<span><span class="co">##     Scale estimate (sigma): 0.367</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##   SR information:</span></span>
<span><span class="co">##              Vartype Total Selected Saturation Penalty</span></span>
<span><span class="co">##          Main effect    21       11      0.524    4.58</span></span>
<span><span class="co">##  Order 1 interaction   174       24      0.138   13.19</span></span>
<span><span class="co">##   Order 2 polynomial     9        6      0.667    5.48</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Model summary @ CV1se:</span></span>
<span><span class="co">## -----------------------------------------------------</span></span>
<span><span class="co">##   lasso-penalized linear regression with n=770, p=204</span></span>
<span><span class="co">##   (At lambda=0.0093):</span></span>
<span><span class="co">##     Nonzero coefficients: 4</span></span>
<span><span class="co">##     Cross-validation error (deviance): 0.14</span></span>
<span><span class="co">##     R-squared: 0.40</span></span>
<span><span class="co">##     Signal-to-noise ratio: 0.66</span></span>
<span><span class="co">##     Scale estimate (sigma): 0.377</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##   SR information:</span></span>
<span><span class="co">##              Vartype Total Selected Saturation Penalty</span></span>
<span><span class="co">##          Main effect    21        3      0.143    4.58</span></span>
<span><span class="co">##  Order 1 interaction   174        0      0.000   13.19</span></span>
<span><span class="co">##   Order 2 polynomial     9        1      0.111    5.48</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $APL</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Model summary @ min CV:</span></span>
<span><span class="co">## -----------------------------------------------------</span></span>
<span><span class="co">##   lasso-penalized linear regression with n=770, p=204</span></span>
<span><span class="co">##   (At lambda=0.0100):</span></span>
<span><span class="co">##     Nonzero coefficients: 43</span></span>
<span><span class="co">##     Cross-validation error (deviance): 0.13</span></span>
<span><span class="co">##     R-squared: 0.43</span></span>
<span><span class="co">##     Signal-to-noise ratio: 0.75</span></span>
<span><span class="co">##     Scale estimate (sigma): 0.367</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##   SR information:</span></span>
<span><span class="co">##              Vartype Total Selected Saturation Penalty</span></span>
<span><span class="co">##          Main effect    21        4      0.190       1</span></span>
<span><span class="co">##  Order 1 interaction   174       37      0.213       1</span></span>
<span><span class="co">##   Order 2 polynomial     9        2      0.222       1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Model summary @ CV1se:</span></span>
<span><span class="co">## -----------------------------------------------------</span></span>
<span><span class="co">##   lasso-penalized linear regression with n=770, p=204</span></span>
<span><span class="co">##   (At lambda=0.0425):</span></span>
<span><span class="co">##     Nonzero coefficients: 10</span></span>
<span><span class="co">##     Cross-validation error (deviance): 0.14</span></span>
<span><span class="co">##     R-squared: 0.40</span></span>
<span><span class="co">##     Signal-to-noise ratio: 0.66</span></span>
<span><span class="co">##     Scale estimate (sigma): 0.377</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##   SR information:</span></span>
<span><span class="co">##              Vartype Total Selected Saturation Penalty</span></span>
<span><span class="co">##          Main effect    21        3     0.1429       1</span></span>
<span><span class="co">##  Order 1 interaction   174        6     0.0345       1</span></span>
<span><span class="co">##   Order 2 polynomial     9        1     0.1111       1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $ME</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Model summary @ min CV:</span></span>
<span><span class="co">## -----------------------------------------------------</span></span>
<span><span class="co">##   lasso-penalized linear regression with n=770, p=30</span></span>
<span><span class="co">##   (At lambda=0.0034):</span></span>
<span><span class="co">##     Nonzero coefficients: 11</span></span>
<span><span class="co">##     Cross-validation error (deviance): 0.14</span></span>
<span><span class="co">##     R-squared: 0.42</span></span>
<span><span class="co">##     Signal-to-noise ratio: 0.71</span></span>
<span><span class="co">##     Scale estimate (sigma): 0.371</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##   SR information:</span></span>
<span><span class="co">##             Vartype Total Selected Saturation Penalty</span></span>
<span><span class="co">##         Main effect    21       10      0.476    4.58</span></span>
<span><span class="co">##  Order 2 polynomial     9        1      0.111    5.48</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Model summary @ CV1se:</span></span>
<span><span class="co">## -----------------------------------------------------</span></span>
<span><span class="co">##   lasso-penalized linear regression with n=770, p=30</span></span>
<span><span class="co">##   (At lambda=0.0142):</span></span>
<span><span class="co">##     Nonzero coefficients: 3</span></span>
<span><span class="co">##     Cross-validation error (deviance): 0.15</span></span>
<span><span class="co">##     R-squared: 0.39</span></span>
<span><span class="co">##     Signal-to-noise ratio: 0.63</span></span>
<span><span class="co">##     Scale estimate (sigma): 0.381</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##   SR information:</span></span>
<span><span class="co">##             Vartype Total Selected Saturation Penalty</span></span>
<span><span class="co">##         Main effect    21        3      0.143    4.58</span></span>
<span><span class="co">##  Order 2 polynomial     9        0      0.000    5.48</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $SRLp</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Model summary @ min CV:</span></span>
<span><span class="co">## -----------------------------------------------------</span></span>
<span><span class="co">##   lasso-penalized linear regression with n=770, p=204</span></span>
<span><span class="co">##   (At lambda=0.0009):</span></span>
<span><span class="co">##     Nonzero coefficients: 41</span></span>
<span><span class="co">##     Cross-validation error (deviance): 0.13</span></span>
<span><span class="co">##     R-squared: 0.43</span></span>
<span><span class="co">##     Signal-to-noise ratio: 0.75</span></span>
<span><span class="co">##     Scale estimate (sigma): 0.367</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##   SR information:</span></span>
<span><span class="co">##              Vartype Total Selected Saturation Penalty</span></span>
<span><span class="co">##          Main effect    21       11      0.524    4.58</span></span>
<span><span class="co">##  Order 1 interaction   174       24      0.138   13.19</span></span>
<span><span class="co">##   Order 2 polynomial     9        6      0.667    5.48</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Model summary @ CV1se:</span></span>
<span><span class="co">## -----------------------------------------------------</span></span>
<span><span class="co">##   lasso-penalized linear regression with n=770, p=204</span></span>
<span><span class="co">##   (At lambda=0.0093):</span></span>
<span><span class="co">##     Nonzero coefficients: 4</span></span>
<span><span class="co">##     Cross-validation error (deviance): 0.14</span></span>
<span><span class="co">##     R-squared: 0.40</span></span>
<span><span class="co">##     Signal-to-noise ratio: 0.66</span></span>
<span><span class="co">##     Scale estimate (sigma): 0.377</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##   SR information:</span></span>
<span><span class="co">##              Vartype Total Selected Saturation Penalty</span></span>
<span><span class="co">##          Main effect    21        3      0.143    4.58</span></span>
<span><span class="co">##  Order 1 interaction   174        0      0.000   13.19</span></span>
<span><span class="co">##   Order 2 polynomial     9        1      0.111    5.48</span></span></code></pre></div>
<p>Similarly, plots can be produced of all of these figures:</p>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">lso</span>, <span class="va">plot</span>, log.l <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="sparseR_files/figure-html/unnamed-chunk-48-1.png" width="672"></p>
<p>MCP:</p>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mcp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  SRM  <span class="op">=</span> <span class="fu"><a href="../reference/sparseR.html">sparseR</a></span><span class="op">(</span><span class="va">CASE</span> <span class="op">~</span> <span class="va">.</span>, <span class="va">train</span>, seed <span class="op">=</span> <span class="fl">1</span>, penalty <span class="op">=</span> <span class="st">"MCP"</span><span class="op">)</span>,            <span class="co">## SRM model</span></span>
<span>  APM  <span class="op">=</span> <span class="fu"><a href="../reference/sparseR.html">sparseR</a></span><span class="op">(</span><span class="va">CASE</span> <span class="op">~</span> <span class="va">.</span>, <span class="va">train</span>, seed <span class="op">=</span> <span class="fl">1</span>, gamma <span class="op">=</span> <span class="fl">0</span>, penalty <span class="op">=</span> <span class="st">"MCP"</span><span class="op">)</span>, <span class="co">## APM model</span></span>
<span>  MEM   <span class="op">=</span> <span class="fu"><a href="../reference/sparseR.html">sparseR</a></span><span class="op">(</span><span class="va">CASE</span> <span class="op">~</span> <span class="va">.</span>, <span class="va">train</span>, seed <span class="op">=</span> <span class="fl">1</span>, k <span class="op">=</span> <span class="fl">0</span>, penalty <span class="op">=</span> <span class="st">"MCP"</span><span class="op">)</span>,     <span class="co">## Main effects MCP model</span></span>
<span>  SRMp <span class="op">=</span> <span class="fu"><a href="../reference/sparseR.html">sparseR</a></span><span class="op">(</span><span class="va">CASE</span> <span class="op">~</span> <span class="va">.</span>, <span class="va">train</span>, seed <span class="op">=</span> <span class="fl">1</span>, poly <span class="op">=</span> <span class="fl">2</span>, penalty <span class="op">=</span> <span class="st">"MCP"</span><span class="op">)</span>   <span class="co">## SRM + polynomials</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">mcp</span>, <span class="va">plot</span>, log.l <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="sparseR_files/figure-html/unnamed-chunk-51-1.png" width="672"></p>
<p>SCAD (not evaluated):</p>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">scad</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  SRS  <span class="op">=</span> <span class="fu"><a href="../reference/sparseR.html">sparseR</a></span><span class="op">(</span><span class="va">CASE</span> <span class="op">~</span> <span class="va">.</span>, <span class="va">train</span>, seed <span class="op">=</span> <span class="fl">1</span>, penalty <span class="op">=</span> <span class="st">"SCAD"</span><span class="op">)</span>,            <span class="co">## SRS model</span></span>
<span>  APS  <span class="op">=</span> <span class="fu"><a href="../reference/sparseR.html">sparseR</a></span><span class="op">(</span><span class="va">CASE</span> <span class="op">~</span> <span class="va">.</span>, <span class="va">train</span>, seed <span class="op">=</span> <span class="fl">1</span>, gamma <span class="op">=</span> <span class="fl">0</span>, penalty <span class="op">=</span> <span class="st">"SCAD"</span><span class="op">)</span>, <span class="co">## APS model</span></span>
<span>  MES   <span class="op">=</span> <span class="fu"><a href="../reference/sparseR.html">sparseR</a></span><span class="op">(</span><span class="va">CASE</span> <span class="op">~</span> <span class="va">.</span>, <span class="va">train</span>, seed <span class="op">=</span> <span class="fl">1</span>, k <span class="op">=</span> <span class="fl">0</span>, penalty <span class="op">=</span> <span class="st">"SCAD"</span><span class="op">)</span>,    <span class="co">## Main effects SCAD model</span></span>
<span>  SRSp <span class="op">=</span> <span class="fu"><a href="../reference/sparseR.html">sparseR</a></span><span class="op">(</span><span class="va">CASE</span> <span class="op">~</span> <span class="va">.</span>, <span class="va">train</span>, seed <span class="op">=</span> <span class="fl">1</span>, poly <span class="op">=</span> <span class="fl">2</span>, penalty <span class="op">=</span> <span class="st">"SCAD"</span><span class="op">)</span>   <span class="co">## SRS + polynomials</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">scad</span>, <span class="va">plot</span>, log.l <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p>Summaries (using <code>results_summary</code> and
<code>results_1se_summary</code> values within each object; formatting
omitted).</p>
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">lso</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu">bind_rows</span><span class="op">(</span><span class="va">x</span><span class="op">$</span><span class="va">results_summary</span>, <span class="va">x</span><span class="op">$</span><span class="va">results1se_summary</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">mcp</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu">bind_rows</span><span class="op">(</span><span class="va">x</span><span class="op">$</span><span class="va">results_summary</span>, <span class="va">x</span><span class="op">$</span><span class="va">results1se_summary</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<table class="table table table-striped" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="empty-cells: hide;border-bottom:hidden;" colspan="3">
</th>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="2">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Min CV
</div>
</th>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="2">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
CV1se
</div>
</th>
</tr>
<tr>
<th style="text-align:left;">
Vartype
</th>
<th style="text-align:right;">
Penalty
</th>
<th style="text-align:right;">
Total
</th>
<th style="text-align:right;">
Selected
</th>
<th style="text-align:right;">
Saturation
</th>
<th style="text-align:right;">
Selected
</th>
<th style="text-align:right;">
Saturation
</th>
</tr>
</thead>
<tbody>
<tr grouplength="2">
<td colspan="7" style="border-bottom: 1px solid;">
<strong>SRL</strong>
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
Main effect
</td>
<td style="text-align:right;">
4.583
</td>
<td style="text-align:right;">
21
</td>
<td style="text-align:right;">
11
</td>
<td style="text-align:right;">
0.524
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
0.143
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
Order 1 interaction
</td>
<td style="text-align:right;">
13.191
</td>
<td style="text-align:right;">
174
</td>
<td style="text-align:right;">
24
</td>
<td style="text-align:right;">
0.138
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.000
</td>
</tr>
<tr grouplength="2">
<td colspan="7" style="border-bottom: 1px solid;">
<strong>APL</strong>
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
Order 2 polynomial
</td>
<td style="text-align:right;">
5.477
</td>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
0.667
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.111
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
Main effect
</td>
<td style="text-align:right;">
1.000
</td>
<td style="text-align:right;">
21
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
0.190
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
0.143
</td>
</tr>
<tr grouplength="1">
<td colspan="7" style="border-bottom: 1px solid;">
<strong>MEL</strong>
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
Order 1 interaction
</td>
<td style="text-align:right;">
1.000
</td>
<td style="text-align:right;">
174
</td>
<td style="text-align:right;">
37
</td>
<td style="text-align:right;">
0.213
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
0.034
</td>
</tr>
<tr grouplength="3">
<td colspan="7" style="border-bottom: 1px solid;">
<strong>SRLp</strong>
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
Order 2 polynomial
</td>
<td style="text-align:right;">
1.000
</td>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0.222
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.111
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
Main effect
</td>
<td style="text-align:right;">
4.583
</td>
<td style="text-align:right;">
21
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
0.476
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
0.143
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
Order 2 polynomial
</td>
<td style="text-align:right;">
5.477
</td>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.111
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.000
</td>
</tr>
<tr>
<td style="text-align:left;">
Main effect
</td>
<td style="text-align:right;">
4.583
</td>
<td style="text-align:right;">
21
</td>
<td style="text-align:right;">
11
</td>
<td style="text-align:right;">
0.524
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
0.143
</td>
</tr>
<tr>
<td style="text-align:left;">
Order 1 interaction
</td>
<td style="text-align:right;">
13.191
</td>
<td style="text-align:right;">
174
</td>
<td style="text-align:right;">
24
</td>
<td style="text-align:right;">
0.138
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.000
</td>
</tr>
<tr>
<td style="text-align:left;">
Order 2 polynomial
</td>
<td style="text-align:right;">
5.477
</td>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
0.667
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.111
</td>
</tr>
</tbody>
</table>
<table class="table table table-striped" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="empty-cells: hide;border-bottom:hidden;" colspan="3">
</th>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="2">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Min CV
</div>
</th>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="2">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
CV1se
</div>
</th>
</tr>
<tr>
<th style="text-align:left;">
Vartype
</th>
<th style="text-align:right;">
Penalty
</th>
<th style="text-align:right;">
Total
</th>
<th style="text-align:right;">
Selected
</th>
<th style="text-align:right;">
Saturation
</th>
<th style="text-align:right;">
Selected
</th>
<th style="text-align:right;">
Saturation
</th>
</tr>
</thead>
<tbody>
<tr grouplength="2">
<td colspan="7" style="border-bottom: 1px solid;">
<strong>SRM</strong>
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
Main effect
</td>
<td style="text-align:right;">
4.583
</td>
<td style="text-align:right;">
21
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
0.238
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.048
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
Order 1 interaction
</td>
<td style="text-align:right;">
13.191
</td>
<td style="text-align:right;">
174
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
0.046
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.000
</td>
</tr>
<tr grouplength="2">
<td colspan="7" style="border-bottom: 1px solid;">
<strong>APM</strong>
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
Order 2 polynomial
</td>
<td style="text-align:right;">
5.477
</td>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
0.556
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.000
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
Main effect
</td>
<td style="text-align:right;">
1.000
</td>
<td style="text-align:right;">
21
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.048
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.048
</td>
</tr>
<tr grouplength="1">
<td colspan="7" style="border-bottom: 1px solid;">
<strong>MEM</strong>
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
Order 1 interaction
</td>
<td style="text-align:right;">
1.000
</td>
<td style="text-align:right;">
174
</td>
<td style="text-align:right;">
13
</td>
<td style="text-align:right;">
0.075
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.000
</td>
</tr>
<tr grouplength="3">
<td colspan="7" style="border-bottom: 1px solid;">
<strong>SRMp</strong>
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
Order 2 polynomial
</td>
<td style="text-align:right;">
1.000
</td>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.111
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.000
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
Main effect
</td>
<td style="text-align:right;">
4.583
</td>
<td style="text-align:right;">
21
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
0.190
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.048
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
Order 2 polynomial
</td>
<td style="text-align:right;">
5.477
</td>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0.222
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.000
</td>
</tr>
<tr>
<td style="text-align:left;">
Main effect
</td>
<td style="text-align:right;">
4.583
</td>
<td style="text-align:right;">
21
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
0.238
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.048
</td>
</tr>
<tr>
<td style="text-align:left;">
Order 1 interaction
</td>
<td style="text-align:right;">
13.191
</td>
<td style="text-align:right;">
174
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
0.046
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.000
</td>
</tr>
<tr>
<td style="text-align:left;">
Order 2 polynomial
</td>
<td style="text-align:right;">
5.477
</td>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
0.556
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.000
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section level2">
<h2 id="use-case-heart-data">Use case: heart data<a class="anchor" aria-label="anchor" href="#use-case-heart-data"></a>
</h2>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co">## Load Data set, correctly code factors + outcome</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"Detrano"</span><span class="op">)</span></span>
<span><span class="va">cleveland</span><span class="op">$</span><span class="va">thal</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">cleveland</span><span class="op">$</span><span class="va">thal</span><span class="op">)</span></span>
<span><span class="va">cleveland</span><span class="op">$</span><span class="va">case</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">*</span><span class="op">(</span><span class="va">cleveland</span><span class="op">$</span><span class="va">num</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Convert variables into factor variables if necessary!</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">cleveland</span><span class="op">)</span></span>
<span><span class="co">##       age             sex               cp           trestbps    </span></span>
<span><span class="co">##  Min.   :29.00   Min.   :0.0000   Min.   :1.000   Min.   : 94.0  </span></span>
<span><span class="co">##  1st Qu.:48.00   1st Qu.:0.0000   1st Qu.:3.000   1st Qu.:120.0  </span></span>
<span><span class="co">##  Median :56.00   Median :1.0000   Median :3.000   Median :130.0  </span></span>
<span><span class="co">##  Mean   :54.44   Mean   :0.6799   Mean   :3.158   Mean   :131.7  </span></span>
<span><span class="co">##  3rd Qu.:61.00   3rd Qu.:1.0000   3rd Qu.:4.000   3rd Qu.:140.0  </span></span>
<span><span class="co">##  Max.   :77.00   Max.   :1.0000   Max.   :4.000   Max.   :200.0  </span></span>
<span><span class="co">##                                                                  </span></span>
<span><span class="co">##       chol            fbs            restecg          thalach     </span></span>
<span><span class="co">##  Min.   :126.0   Min.   :0.0000   Min.   :0.0000   Min.   : 71.0  </span></span>
<span><span class="co">##  1st Qu.:211.0   1st Qu.:0.0000   1st Qu.:0.0000   1st Qu.:133.5  </span></span>
<span><span class="co">##  Median :241.0   Median :0.0000   Median :1.0000   Median :153.0  </span></span>
<span><span class="co">##  Mean   :246.7   Mean   :0.1485   Mean   :0.9901   Mean   :149.6  </span></span>
<span><span class="co">##  3rd Qu.:275.0   3rd Qu.:0.0000   3rd Qu.:2.0000   3rd Qu.:166.0  </span></span>
<span><span class="co">##  Max.   :564.0   Max.   :1.0000   Max.   :2.0000   Max.   :202.0  </span></span>
<span><span class="co">##                                                                   </span></span>
<span><span class="co">##      exang           oldpeak         slope             ca           thal    </span></span>
<span><span class="co">##  Min.   :0.0000   Min.   :0.00   Min.   :1.000   Min.   :0.0000   3   :166  </span></span>
<span><span class="co">##  1st Qu.:0.0000   1st Qu.:0.00   1st Qu.:1.000   1st Qu.:0.0000   6   : 18  </span></span>
<span><span class="co">##  Median :0.0000   Median :0.80   Median :2.000   Median :0.0000   7   :117  </span></span>
<span><span class="co">##  Mean   :0.3267   Mean   :1.04   Mean   :1.601   Mean   :0.6722   NA's:  2  </span></span>
<span><span class="co">##  3rd Qu.:1.0000   3rd Qu.:1.60   3rd Qu.:2.000   3rd Qu.:1.0000             </span></span>
<span><span class="co">##  Max.   :1.0000   Max.   :6.20   Max.   :3.000   Max.   :3.0000             </span></span>
<span><span class="co">##                                                  NA's   :4                  </span></span>
<span><span class="co">##       num              case       </span></span>
<span><span class="co">##  Min.   :0.0000   Min.   :0.0000  </span></span>
<span><span class="co">##  1st Qu.:0.0000   1st Qu.:0.0000  </span></span>
<span><span class="co">##  Median :0.0000   Median :0.0000  </span></span>
<span><span class="co">##  Mean   :0.9373   Mean   :0.4587  </span></span>
<span><span class="co">##  3rd Qu.:2.0000   3rd Qu.:1.0000  </span></span>
<span><span class="co">##  Max.   :4.0000   Max.   :1.0000  </span></span>
<span><span class="co">## </span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">cleveland</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">##      age      sex       cp trestbps     chol      fbs  restecg  thalach </span></span>
<span><span class="co">##       41        2        4       50      152        2        3       91 </span></span>
<span><span class="co">##    exang  oldpeak    slope       ca     thal      num     case </span></span>
<span><span class="co">##        2       40        3        5        4        5        2</span></span>
<span><span class="va">cleveland</span><span class="op">$</span><span class="va">sex</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">cleveland</span><span class="op">$</span><span class="va">sex</span><span class="op">)</span></span>
<span><span class="va">cleveland</span><span class="op">$</span><span class="va">fbs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">cleveland</span><span class="op">$</span><span class="va">fbs</span><span class="op">)</span></span>
<span><span class="va">cleveland</span><span class="op">$</span><span class="va">exang</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">cleveland</span><span class="op">$</span><span class="va">exang</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Set seed for reproducibility</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">167</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Split data into test and train</span></span>
<span><span class="va">N</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">cleveland</span><span class="op">)</span></span>
<span><span class="va">trainIDX</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">N</span>, <span class="va">N</span><span class="op">*</span><span class="fl">.5</span><span class="op">)</span></span>
<span><span class="va">trainDF</span> <span class="op">&lt;-</span> <span class="va">cleveland</span><span class="op">[</span><span class="va">trainIDX</span>,<span class="op">]</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="op">-</span><span class="va">num</span><span class="op">)</span></span>
<span><span class="va">testDF</span> <span class="op">&lt;-</span> <span class="va">cleveland</span><span class="op">[</span><span class="op">-</span><span class="va">trainIDX</span>,<span class="op">]</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="op">-</span><span class="va">num</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Simulate missing data</span></span>
<span><span class="va">trainDF</span><span class="op">$</span><span class="va">thal</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">trainDF</span><span class="op">$</span><span class="va">thalach</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span>
<span></span>
<span><span class="va">lso</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  SRL  <span class="op">=</span> <span class="fu"><a href="../reference/sparseR.html">sparseR</a></span><span class="op">(</span><span class="va">case</span> <span class="op">~</span> <span class="va">.</span>, <span class="va">trainDF</span>, seed <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>, <span class="co">## SRL model</span></span>
<span>  APL  <span class="op">=</span> <span class="fu"><a href="../reference/sparseR.html">sparseR</a></span><span class="op">(</span><span class="va">case</span> <span class="op">~</span> <span class="va">.</span>, <span class="va">trainDF</span>, seed <span class="op">=</span> <span class="fl">1</span>, gamma <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>, <span class="co">## APL model</span></span>
<span>  ME   <span class="op">=</span> <span class="fu"><a href="../reference/sparseR.html">sparseR</a></span><span class="op">(</span><span class="va">case</span> <span class="op">~</span> <span class="va">.</span>, <span class="va">trainDF</span>, seed <span class="op">=</span> <span class="fl">1</span>, k <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>, <span class="co">## Main effects model</span></span>
<span>  SRLp <span class="op">=</span> <span class="fu"><a href="../reference/sparseR.html">sparseR</a></span><span class="op">(</span><span class="va">case</span> <span class="op">~</span> <span class="va">.</span>, <span class="va">trainDF</span>, seed <span class="op">=</span> <span class="fl">1</span>, poly <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="co">## SRL + polynomials</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">lso</span></span>
<span><span class="co">## $SRL</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Model summary @ min CV:</span></span>
<span><span class="co">## -----------------------------------------------------</span></span>
<span><span class="co">##   lasso-penalized linear regression with n=151, p=162</span></span>
<span><span class="co">##   (At lambda=0.0033):</span></span>
<span><span class="co">##     Nonzero coefficients: 24</span></span>
<span><span class="co">##     Cross-validation error (deviance): 0.12</span></span>
<span><span class="co">##     R-squared: 0.51</span></span>
<span><span class="co">##     Signal-to-noise ratio: 1.04</span></span>
<span><span class="co">##     Scale estimate (sigma): 0.348</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##   SR information:</span></span>
<span><span class="co">##              Vartype Total Selected Saturation Penalty</span></span>
<span><span class="co">##          Main effect    18       14     0.7778    4.24</span></span>
<span><span class="co">##  Order 1 interaction   135        7     0.0519   11.62</span></span>
<span><span class="co">##   Order 2 polynomial     9        3     0.3333    5.20</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Model summary @ CV1se:</span></span>
<span><span class="co">## -----------------------------------------------------</span></span>
<span><span class="co">##   lasso-penalized linear regression with n=151, p=162</span></span>
<span><span class="co">##   (At lambda=0.0156):</span></span>
<span><span class="co">##     Nonzero coefficients: 8</span></span>
<span><span class="co">##     Cross-validation error (deviance): 0.14</span></span>
<span><span class="co">##     R-squared: 0.45</span></span>
<span><span class="co">##     Signal-to-noise ratio: 0.82</span></span>
<span><span class="co">##     Scale estimate (sigma): 0.368</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##   SR information:</span></span>
<span><span class="co">##              Vartype Total Selected Saturation Penalty</span></span>
<span><span class="co">##          Main effect    18        8      0.444    4.24</span></span>
<span><span class="co">##  Order 1 interaction   135        0      0.000   11.62</span></span>
<span><span class="co">##   Order 2 polynomial     9        0      0.000    5.20</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $APL</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Model summary @ min CV:</span></span>
<span><span class="co">## -----------------------------------------------------</span></span>
<span><span class="co">##   lasso-penalized linear regression with n=151, p=162</span></span>
<span><span class="co">##   (At lambda=0.0635):</span></span>
<span><span class="co">##     Nonzero coefficients: 15</span></span>
<span><span class="co">##     Cross-validation error (deviance): 0.14</span></span>
<span><span class="co">##     R-squared: 0.43</span></span>
<span><span class="co">##     Signal-to-noise ratio: 0.74</span></span>
<span><span class="co">##     Scale estimate (sigma): 0.376</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##   SR information:</span></span>
<span><span class="co">##              Vartype Total Selected Saturation Penalty</span></span>
<span><span class="co">##          Main effect    18        6     0.3333       1</span></span>
<span><span class="co">##  Order 1 interaction   135        9     0.0667       1</span></span>
<span><span class="co">##   Order 2 polynomial     9        0     0.0000       1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Model summary @ CV1se:</span></span>
<span><span class="co">## -----------------------------------------------------</span></span>
<span><span class="co">##   lasso-penalized linear regression with n=151, p=162</span></span>
<span><span class="co">##   (At lambda=0.1144):</span></span>
<span><span class="co">##     Nonzero coefficients: 9</span></span>
<span><span class="co">##     Cross-validation error (deviance): 0.15</span></span>
<span><span class="co">##     R-squared: 0.37</span></span>
<span><span class="co">##     Signal-to-noise ratio: 0.59</span></span>
<span><span class="co">##     Scale estimate (sigma): 0.393</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##   SR information:</span></span>
<span><span class="co">##              Vartype Total Selected Saturation Penalty</span></span>
<span><span class="co">##          Main effect    18        5     0.2778       1</span></span>
<span><span class="co">##  Order 1 interaction   135        4     0.0296       1</span></span>
<span><span class="co">##   Order 2 polynomial     9        0     0.0000       1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $ME</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Model summary @ min CV:</span></span>
<span><span class="co">## -----------------------------------------------------</span></span>
<span><span class="co">##   lasso-penalized linear regression with n=151, p=27</span></span>
<span><span class="co">##   (At lambda=0.0024):</span></span>
<span><span class="co">##     Nonzero coefficients: 17</span></span>
<span><span class="co">##     Cross-validation error (deviance): 0.12</span></span>
<span><span class="co">##     R-squared: 0.52</span></span>
<span><span class="co">##     Signal-to-noise ratio: 1.09</span></span>
<span><span class="co">##     Scale estimate (sigma): 0.343</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##   SR information:</span></span>
<span><span class="co">##             Vartype Total Selected Saturation Penalty</span></span>
<span><span class="co">##         Main effect    18       14      0.778    4.24</span></span>
<span><span class="co">##  Order 2 polynomial     9        3      0.333    5.20</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Model summary @ CV1se:</span></span>
<span><span class="co">## -----------------------------------------------------</span></span>
<span><span class="co">##   lasso-penalized linear regression with n=151, p=27</span></span>
<span><span class="co">##   (At lambda=0.0133):</span></span>
<span><span class="co">##     Nonzero coefficients: 11</span></span>
<span><span class="co">##     Cross-validation error (deviance): 0.13</span></span>
<span><span class="co">##     R-squared: 0.46</span></span>
<span><span class="co">##     Signal-to-noise ratio: 0.86</span></span>
<span><span class="co">##     Scale estimate (sigma): 0.364</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##   SR information:</span></span>
<span><span class="co">##             Vartype Total Selected Saturation Penalty</span></span>
<span><span class="co">##         Main effect    18       11      0.611    4.24</span></span>
<span><span class="co">##  Order 2 polynomial     9        0      0.000    5.20</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $SRLp</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Model summary @ min CV:</span></span>
<span><span class="co">## -----------------------------------------------------</span></span>
<span><span class="co">##   lasso-penalized linear regression with n=151, p=162</span></span>
<span><span class="co">##   (At lambda=0.0033):</span></span>
<span><span class="co">##     Nonzero coefficients: 24</span></span>
<span><span class="co">##     Cross-validation error (deviance): 0.12</span></span>
<span><span class="co">##     R-squared: 0.51</span></span>
<span><span class="co">##     Signal-to-noise ratio: 1.04</span></span>
<span><span class="co">##     Scale estimate (sigma): 0.348</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##   SR information:</span></span>
<span><span class="co">##              Vartype Total Selected Saturation Penalty</span></span>
<span><span class="co">##          Main effect    18       14     0.7778    4.24</span></span>
<span><span class="co">##  Order 1 interaction   135        7     0.0519   11.62</span></span>
<span><span class="co">##   Order 2 polynomial     9        3     0.3333    5.20</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Model summary @ CV1se:</span></span>
<span><span class="co">## -----------------------------------------------------</span></span>
<span><span class="co">##   lasso-penalized linear regression with n=151, p=162</span></span>
<span><span class="co">##   (At lambda=0.0156):</span></span>
<span><span class="co">##     Nonzero coefficients: 8</span></span>
<span><span class="co">##     Cross-validation error (deviance): 0.14</span></span>
<span><span class="co">##     R-squared: 0.45</span></span>
<span><span class="co">##     Signal-to-noise ratio: 0.82</span></span>
<span><span class="co">##     Scale estimate (sigma): 0.368</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##   SR information:</span></span>
<span><span class="co">##              Vartype Total Selected Saturation Penalty</span></span>
<span><span class="co">##          Main effect    18        8      0.444    4.24</span></span>
<span><span class="co">##  Order 1 interaction   135        0      0.000   11.62</span></span>
<span><span class="co">##   Order 2 polynomial     9        0      0.000    5.20</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">lso</span><span class="op">$</span><span class="va">SRL</span><span class="op">)</span></span></code></pre></div>
<p><img src="sparseR_files/figure-html/unnamed-chunk-55-1.png" width="672"><img src="sparseR_files/figure-html/unnamed-chunk-55-2.png" width="672"></p>
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">lso</span>, <span class="va">plot</span>, log.l <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="sparseR_files/figure-html/unnamed-chunk-57-1.png" width="672"></p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Ryan Andrew Peterson.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
